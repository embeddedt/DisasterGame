(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{261:function(t,e,i){"use strict";i.r(e),i.d(e,"VERSION",(function(){return w}));i(340);var n=i(18);i.d(e,"ALPHA_MODES",(function(){return n.a})),i.d(e,"BLEND_MODES",(function(){return n.b})),i.d(e,"DRAW_MODES",(function(){return n.c})),i.d(e,"ENV",(function(){return n.d})),i.d(e,"FORMATS",(function(){return n.e})),i.d(e,"GC_MODES",(function(){return n.f})),i.d(e,"MASK_TYPES",(function(){return n.g})),i.d(e,"MIPMAP_MODES",(function(){return n.h})),i.d(e,"PRECISION",(function(){return n.i})),i.d(e,"RENDERER_TYPE",(function(){return n.j})),i.d(e,"SCALE_MODES",(function(){return n.k})),i.d(e,"TARGETS",(function(){return n.l})),i.d(e,"TYPES",(function(){return n.m})),i.d(e,"WRAP_MODES",(function(){return n.n}));var r=i(252);i.d(e,"Circle",(function(){return r.a})),i.d(e,"DEG_TO_RAD",(function(){return r.b})),i.d(e,"Ellipse",(function(){return r.c})),i.d(e,"Matrix",(function(){return r.d})),i.d(e,"ObservablePoint",(function(){return r.e})),i.d(e,"PI_2",(function(){return r.f})),i.d(e,"Point",(function(){return r.g})),i.d(e,"Polygon",(function(){return r.h})),i.d(e,"RAD_TO_DEG",(function(){return r.i})),i.d(e,"Rectangle",(function(){return r.j})),i.d(e,"RoundedRectangle",(function(){return r.k})),i.d(e,"SHAPES",(function(){return r.l})),i.d(e,"Transform",(function(){return r.m})),i.d(e,"groupD8",(function(){return r.n}));var s=i(282);i.d(e,"Runner",(function(){return s.a}));var o=i(24);i.d(e,"isMobile",(function(){return o.a})),i.d(e,"settings",(function(){return o.b}));var a=i(262);i.d(e,"Ticker",(function(){return a.a})),i.d(e,"TickerPlugin",(function(){return a.b})),i.d(e,"UPDATE_PRIORITY",(function(){return a.c}));var l=i(77);i.d(e,"utils",(function(){return l}));var h=i(254);i.d(e,"Bounds",(function(){return h.a})),i.d(e,"Container",(function(){return h.b})),i.d(e,"DisplayObject",(function(){return h.c}));var c=i(250);i.d(e,"AbstractBatchRenderer",(function(){return c.a})),i.d(e,"AbstractRenderer",(function(){return c.b})),i.d(e,"Attribute",(function(){return c.c})),i.d(e,"BaseRenderTexture",(function(){return c.d})),i.d(e,"BaseTexture",(function(){return c.e})),i.d(e,"BatchDrawCall",(function(){return c.f})),i.d(e,"BatchGeometry",(function(){return c.g})),i.d(e,"BatchPluginFactory",(function(){return c.h})),i.d(e,"BatchRenderer",(function(){return c.i})),i.d(e,"BatchShaderGenerator",(function(){return c.j})),i.d(e,"BatchTextureArray",(function(){return c.k})),i.d(e,"Buffer",(function(){return c.l})),i.d(e,"CubeTexture",(function(){return c.m})),i.d(e,"Filter",(function(){return c.n})),i.d(e,"Framebuffer",(function(){return c.o})),i.d(e,"GLProgram",(function(){return c.p})),i.d(e,"GLTexture",(function(){return c.q})),i.d(e,"Geometry",(function(){return c.r})),i.d(e,"MaskData",(function(){return c.s})),i.d(e,"ObjectRenderer",(function(){return c.t})),i.d(e,"Program",(function(){return c.u})),i.d(e,"Quad",(function(){return c.v})),i.d(e,"QuadUv",(function(){return c.w})),i.d(e,"RenderTexture",(function(){return c.x})),i.d(e,"RenderTexturePool",(function(){return c.y})),i.d(e,"Renderer",(function(){return c.z})),i.d(e,"Shader",(function(){return c.A})),i.d(e,"SpriteMaskFilter",(function(){return c.B})),i.d(e,"State",(function(){return c.C})),i.d(e,"System",(function(){return c.D})),i.d(e,"Texture",(function(){return c.E})),i.d(e,"TextureMatrix",(function(){return c.F})),i.d(e,"TextureUvs",(function(){return c.G})),i.d(e,"UniformGroup",(function(){return c.H})),i.d(e,"ViewableBuffer",(function(){return c.I})),i.d(e,"autoDetectRenderer",(function(){return c.J})),i.d(e,"checkMaxIfStatementsInShader",(function(){return c.K})),i.d(e,"defaultFilterVertex",(function(){return c.L})),i.d(e,"defaultVertex",(function(){return c.M})),i.d(e,"resources",(function(){return c.N})),i.d(e,"systems",(function(){return c.O}));var u=i(295);i.d(e,"AppLoaderPlugin",(function(){return u.a})),i.d(e,"Loader",(function(){return u.b})),i.d(e,"LoaderResource",(function(){return u.c})),i.d(e,"TextureLoader",(function(){return u.d}));var p=i(271);i.d(e,"Sprite",(function(){return p.a}));var d=i(283);i.d(e,"Application",(function(){return d.a}));var v=i(284);i.d(e,"FillStyle",(function(){return v.a})),i.d(e,"GRAPHICS_CURVES",(function(){return v.b})),i.d(e,"Graphics",(function(){return v.c})),i.d(e,"GraphicsData",(function(){return v.d})),i.d(e,"GraphicsGeometry",(function(){return v.e})),i.d(e,"LineStyle",(function(){return v.f})),i.d(e,"graphicsUtils",(function(){return v.g}));var f=i(263);i.d(e,"InteractionData",(function(){return f.InteractionData})),i.d(e,"InteractionEvent",(function(){return f.InteractionEvent})),i.d(e,"InteractionManager",(function(){return f.InteractionManager})),i.d(e,"InteractionTrackingData",(function(){return f.InteractionTrackingData})),i.d(e,"interactiveTarget",(function(){return f.interactiveTarget}));var y=i(297);i.d(e,"AnimatedSprite",(function(){return y.a})),i.d(e,"interaction",(function(){return f}));var m=i(285),g=i(347),b=i(348),w=(i(349),"5.2.0");m.a.registerPlugin("graphics",g.a),m.a.registerPlugin("interaction",f.InteractionManager),m.a.registerPlugin("sprite",b.a),c.z.registerPlugin("interaction",f.InteractionManager),c.z.registerPlugin("batch",c.i),d.a.registerPlugin(u.a),d.a.registerPlugin(a.b)},350:function(t,e,i){"use strict";(function(t){i.d(e,"a",(function(){return V}));i(111),i(112),i(113),i(116),i(298),i(110),i(300),i(301),i(302),i(114),i(303),i(304),i(305),i(306),i(307),i(52),i(308),i(310),i(311),i(115),i(53),i(79);var n=i(261);function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e,i){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=h(t)););return t}(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(i):r.value}})(t,e,i||t)}function o(t){return(o="function"==typeof Symbol&&"symbol"===r(Symbol.iterator)?function(t){return r(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":r(t)})(t)}function a(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?l(t):e}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function c(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function p(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function v(t,e,i){return e&&d(t.prototype,e),i&&d(t,i),t}var f=function(){function t(e){p(this,t),this.viewport=e,this.touches=[],this.addListeners()}return v(t,[{key:"addListeners",value:function(){var t=this;this.viewport.interactive=!0,this.viewport.forceHitArea||(this.viewport.hitArea=new n.Rectangle(0,0,this.viewport.worldWidth,this.viewport.worldHeight)),this.viewport.on("pointerdown",this.down,this),this.viewport.on("pointermove",this.move,this),this.viewport.on("pointerup",this.up,this),this.viewport.on("pointerupoutside",this.up,this),this.viewport.on("pointercancel",this.up,this),this.viewport.on("pointerout",this.up,this),this.wheelFunction=function(e){return t.handleWheel(e)},this.viewport.options.divWheel.addEventListener("wheel",this.wheelFunction,{passive:this.viewport.options.passiveWheel}),this.isMouseDown=!1}},{key:"destroy",value:function(){this.viewport.options.divWheel.removeEventListener("wheel",this.wheelFunction)}},{key:"down",value:function(t){if(!this.viewport.pause&&this.viewport.worldVisible){if("mouse"===t.data.pointerType?this.isMouseDown=!0:this.get(t.data.pointerId)||this.touches.push({id:t.data.pointerId,last:null}),1===this.count()){this.last=t.data.global.clone();var e=this.viewport.plugins.get("decelerate"),i=this.viewport.plugins.get("bounce");e&&e.isActive()||i&&i.isActive()?this.clickedAvailable=!1:this.clickedAvailable=!0}else this.clickedAvailable=!1;this.viewport.plugins.down(t)&&this.viewport.options.stopPropagation&&t.stopPropagation()}}},{key:"checkThreshold",value:function(t){return Math.abs(t)>=this.viewport.threshold}},{key:"move",value:function(t){if(!this.viewport.pause&&this.viewport.worldVisible){var e=this.viewport.plugins.move(t);if(this.clickedAvailable){var i=t.data.global.x-this.last.x,n=t.data.global.y-this.last.y;(this.checkThreshold(i)||this.checkThreshold(n))&&(this.clickedAvailable=!1)}e&&this.viewport.options.stopPropagation&&t.stopPropagation()}}},{key:"up",value:function(t){if(!this.viewport.pause&&this.viewport.worldVisible){"mouse"===t.data.pointerType&&(this.isMouseDown=!1),"mouse"!==t.data.pointerType&&this.remove(t.data.pointerId);var e=this.viewport.plugins.up(t);this.clickedAvailable&&0===this.count()&&(this.viewport.emit("clicked",{screen:this.last,world:this.viewport.toWorld(this.last),viewport:this}),this.clickedAvailable=!1),e&&this.viewport.options.stopPropagation&&t.stopPropagation()}}},{key:"getPointerPosition",value:function(t){var e=new n.Point;return this.viewport.options.interaction?this.viewport.options.interaction.mapPositionToPoint(e,t.clientX,t.clientY):(e.x=t.clientX,e.y=t.clientY),e}},{key:"handleWheel",value:function(t){if(!this.viewport.pause&&this.viewport.worldVisible){var e=this.viewport.toLocal(this.getPointerPosition(t));if(this.viewport.left<=e.x&&e.x<=this.viewport.right&&this.viewport.top<=e.y&&e.y<=this.viewport.bottom)this.viewport.plugins.wheel(t)&&t.preventDefault()}}},{key:"pause",value:function(){this.touches=[],this.isMouseDown=!1}},{key:"get",value:function(t){var e=!0,i=!1,n=void 0;try{for(var r,s=this.touches[Symbol.iterator]();!(e=(r=s.next()).done);e=!0){var o=r.value;if(o.id===t)return o}}catch(t){i=!0,n=t}finally{try{e||null==s.return||s.return()}finally{if(i)throw n}}return null}},{key:"remove",value:function(t){for(var e=0;e<this.touches.length;e++)if(this.touches[e].id===t)return void this.touches.splice(e,1)}},{key:"count",value:function(){return(this.isMouseDown?1:0)+this.touches.length}}]),t}(),y=["drag","pinch","wheel","follow","mouse-edges","decelerate","bounce","snap-zoom","clamp-zoom","snap","clamp"],m=function(){function t(e){p(this,t),this.viewport=e,this.list=[],this.plugins={}}return v(t,[{key:"add",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:y.length;this.plugins[t]=e;var n=y.indexOf(t);-1!==n&&y.splice(n,1),y.splice(i,0,t),this.sort()}},{key:"get",value:function(t){return this.plugins[t]}},{key:"update",value:function(t){var e=!0,i=!1,n=void 0;try{for(var r,s=this.list[Symbol.iterator]();!(e=(r=s.next()).done);e=!0){r.value.update(t)}}catch(t){i=!0,n=t}finally{try{e||null==s.return||s.return()}finally{if(i)throw n}}}},{key:"resize",value:function(){var t=!0,e=!1,i=void 0;try{for(var n,r=this.list[Symbol.iterator]();!(t=(n=r.next()).done);t=!0){n.value.resize()}}catch(t){e=!0,i=t}finally{try{t||null==r.return||r.return()}finally{if(e)throw i}}}},{key:"reset",value:function(){var t=!0,e=!1,i=void 0;try{for(var n,r=this.list[Symbol.iterator]();!(t=(n=r.next()).done);t=!0){n.value.reset()}}catch(t){e=!0,i=t}finally{try{t||null==r.return||r.return()}finally{if(e)throw i}}}},{key:"remove",value:function(t){this.plugins[t]&&(this.plugins[t]=null,this.viewport.emit(t+"-remove"),this.sort())}},{key:"pause",value:function(t){this.plugins[t]&&this.plugins[t].pause()}},{key:"resume",value:function(t){this.plugins[t]&&this.plugins[t].resume()}},{key:"sort",value:function(){this.list=[];var t=!0,e=!1,i=void 0;try{for(var n,r=y[Symbol.iterator]();!(t=(n=r.next()).done);t=!0){var s=n.value;this.plugins[s]&&this.list.push(this.plugins[s])}}catch(t){e=!0,i=t}finally{try{t||null==r.return||r.return()}finally{if(e)throw i}}}},{key:"down",value:function(t){var e=!1,i=!0,n=!1,r=void 0;try{for(var s,o=this.list[Symbol.iterator]();!(i=(s=o.next()).done);i=!0){s.value.down(t)&&(e=!0)}}catch(t){n=!0,r=t}finally{try{i||null==o.return||o.return()}finally{if(n)throw r}}return e}},{key:"move",value:function(t){var e=!1,i=!0,n=!1,r=void 0;try{for(var s,o=this.viewport.plugins.list[Symbol.iterator]();!(i=(s=o.next()).done);i=!0){s.value.move(t)&&(e=!0)}}catch(t){n=!0,r=t}finally{try{i||null==o.return||o.return()}finally{if(n)throw r}}return e}},{key:"up",value:function(t){var e=!1,i=!0,n=!1,r=void 0;try{for(var s,o=this.list[Symbol.iterator]();!(i=(s=o.next()).done);i=!0){s.value.up(t)&&(e=!0)}}catch(t){n=!0,r=t}finally{try{i||null==o.return||o.return()}finally{if(n)throw r}}return e}},{key:"wheel",value:function(t){var e=!1,i=!0,n=!1,r=void 0;try{for(var s,o=this.list[Symbol.iterator]();!(i=(s=o.next()).done);i=!0){s.value.wheel(t)&&(e=!0)}}catch(t){n=!0,r=t}finally{try{i||null==o.return||o.return()}finally{if(n)throw r}}return e}}]),t}(),g=function(){function t(e){p(this,t),this.parent=e,this.paused=!1}return v(t,[{key:"destroy",value:function(){}},{key:"down",value:function(){return!1}},{key:"move",value:function(){return!1}},{key:"up",value:function(){return!1}},{key:"wheel",value:function(){return!1}},{key:"update",value:function(){}},{key:"resize",value:function(){}},{key:"reset",value:function(){}},{key:"pause",value:function(){this.paused=!0}},{key:"resume",value:function(){this.paused=!1}}]),t}(),b={direction:"all",wheel:!0,wheelScroll:1,reverse:!1,clampWheel:!1,underflow:"center",factor:1,mouseButtons:"all",keyToPress:null,ignoreKeyToPressOnTouch:!1},w=function(t){function e(t){var i,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return p(this,e),(i=a(this,h(e).call(this,t))).options=Object.assign({},b,n),i.moved=!1,i.reverse=i.options.reverse?1:-1,i.xDirection=!i.options.direction||"all"===i.options.direction||"x"===i.options.direction,i.yDirection=!i.options.direction||"all"===i.options.direction||"y"===i.options.direction,i.keyIsPressed=!1,i.parseUnderflow(),i.mouseButtons(i.options.mouseButtons),i.options.keyToPress&&i.handleKeyPresses(i.options.keyToPress),i}return c(e,t),v(e,[{key:"handleKeyPresses",value:function(t){var e=this;parent.addEventListener("keydown",(function(i){t.includes(i.code)&&(e.keyIsPressed=!0)})),parent.addEventListener("keyup",(function(i){t.includes(i.code)&&(e.keyIsPressed=!1)}))}},{key:"mouseButtons",value:function(t){this.mouse=t&&"all"!==t?[-1!==t.indexOf("left"),-1!==t.indexOf("middle"),-1!==t.indexOf("right")]:[!0,!0,!0]}},{key:"parseUnderflow",value:function(){var t=this.options.underflow.toLowerCase();"center"===t?(this.underflowX=0,this.underflowY=0):(this.underflowX=-1!==t.indexOf("left")?-1:-1!==t.indexOf("right")?1:0,this.underflowY=-1!==t.indexOf("top")?-1:-1!==t.indexOf("bottom")?1:0)}},{key:"checkButtons",value:function(t){var e="mouse"===t.data.pointerType,i=this.parent.input.count();return!(!(1===i||i>1&&!this.parent.plugins.get("pinch"))||e&&!this.mouse[t.data.button])}},{key:"checkKeyPress",value:function(t){return!!(!this.options.keyToPress||this.keyIsPressed||this.options.ignoreKeyToPressOnTouch&&"touch"===t.data.pointerType)}},{key:"down",value:function(t){if(!this.paused)return this.checkButtons(t)&&this.checkKeyPress(t)?(this.last={x:t.data.global.x,y:t.data.global.y},this.current=t.data.pointerId,!0):void(this.last=null)}},{key:"move",value:function(t){if(!this.paused&&this.last&&this.current===t.data.pointerId){var e=t.data.global.x,i=t.data.global.y,r=this.parent.input.count();if(1===r||r>1&&!this.parent.plugins.get("pinch")){var s=e-this.last.x,o=i-this.last.y;if(this.moved||this.xDirection&&this.parent.input.checkThreshold(s)||this.yDirection&&this.parent.input.checkThreshold(o)){var a={x:e,y:i};return this.xDirection&&(this.parent.x+=(a.x-this.last.x)*this.options.factor),this.yDirection&&(this.parent.y+=(a.y-this.last.y)*this.options.factor),this.last=a,this.moved||this.parent.emit("drag-start",{screen:new n.Point(this.last.x,this.last.y),world:this.parent.toWorld(new n.Point(this.last.x,this.last.y)),viewport:this.parent}),this.moved=!0,this.parent.emit("moved",{viewport:this.parent,type:"drag"}),!0}}else this.moved=!1}}},{key:"up",value:function(){if(!this.paused){var t=this.parent.input.touches;if(1===t.length){var e=t[0];return e.last&&(this.last={x:e.last.x,y:e.last.y},this.current=e.id),this.moved=!1,!0}if(this.last&&this.moved){var i=new n.Point(this.last.x,this.last.y);return this.parent.emit("drag-end",{screen:i,world:this.parent.toWorld(i),viewport:this.parent}),this.last=null,this.moved=!1,!0}}}},{key:"wheel",value:function(t){if(!this.paused&&this.options.wheel){var e=this.parent.plugins.get("wheel");if(!e)return this.xDirection&&(this.parent.x+=t.deltaX*this.options.wheelScroll*this.reverse),this.yDirection&&(this.parent.y+=t.deltaY*this.options.wheelScroll*this.reverse),this.options.clampWheel&&this.clamp(),this.parent.emit("wheel-scroll",this.parent),this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.parent.options.passiveWheel||t.preventDefault(),!0}}},{key:"resume",value:function(){this.last=null,this.paused=!1}},{key:"clamp",value:function(){var t=this.parent.plugins.get("decelerate")||{};if("y"!==this.options.clampWheel)if(this.parent.screenWorldWidth<this.parent.screenWidth)switch(this.underflowX){case-1:this.parent.x=0;break;case 1:this.parent.x=this.parent.screenWidth-this.parent.screenWorldWidth;break;default:this.parent.x=(this.parent.screenWidth-this.parent.screenWorldWidth)/2}else this.parent.left<0?(this.parent.x=0,t.x=0):this.parent.right>this.parent.worldWidth&&(this.parent.x=-this.parent.worldWidth*this.parent.scale.x+this.parent.screenWidth,t.x=0);if("x"!==this.options.clampWheel)if(this.parent.screenWorldHeight<this.parent.screenHeight)switch(this.underflowY){case-1:this.parent.y=0;break;case 1:this.parent.y=this.parent.screenHeight-this.parent.screenWorldHeight;break;default:this.parent.y=(this.parent.screenHeight-this.parent.screenWorldHeight)/2}else this.parent.top<0&&(this.parent.y=0,t.y=0),this.parent.bottom>this.parent.worldHeight&&(this.parent.y=-this.parent.worldHeight*this.parent.scale.y+this.parent.screenHeight,t.y=0)}},{key:"active",get:function(){return this.moved}}]),e}(g),x={noDrag:!1,percent:1,center:null},S=function(t){function e(t){var i,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return p(this,e),(i=a(this,h(e).call(this,t))).options=Object.assign({},x,n),i}return c(e,t),v(e,[{key:"down",value:function(){if(this.parent.input.count()>=2)return this.active=!0,!0}},{key:"move",value:function(t){if(!this.paused&&this.active){var e=t.data.global.x,i=t.data.global.y,n=this.parent.input.touches;if(n.length>=2){var r=n[0],s=n[1],o=r.last&&s.last?Math.sqrt(Math.pow(s.last.x-r.last.x,2)+Math.pow(s.last.y-r.last.y,2)):null;if(r.id===t.data.pointerId?r.last={x:e,y:i,data:t.data}:s.id===t.data.pointerId&&(s.last={x:e,y:i,data:t.data}),o){var a,l={x:r.last.x+(s.last.x-r.last.x)/2,y:r.last.y+(s.last.y-r.last.y)/2};this.options.center||(a=this.parent.toLocal(l));var h=(Math.sqrt(Math.pow(s.last.x-r.last.x,2)+Math.pow(s.last.y-r.last.y,2))-o)/this.parent.screenWidth*this.parent.scale.x*this.options.percent;this.parent.scale.x+=h,this.parent.scale.y+=h,this.parent.emit("zoomed",{viewport:this.parent,type:"pinch"});var c=this.parent.plugins.get("clamp-zoom");if(c&&c.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{var u=this.parent.toGlobal(a);this.parent.x+=l.x-u.x,this.parent.y+=l.y-u.y,this.parent.emit("moved",{viewport:this.parent,type:"pinch"})}!this.options.noDrag&&this.lastCenter&&(this.parent.x+=l.x-this.lastCenter.x,this.parent.y+=l.y-this.lastCenter.y,this.parent.emit("moved",{viewport:this.parent,type:"pinch"})),this.lastCenter=l,this.moved=!0}else this.pinching||(this.parent.emit("pinch-start",this.parent),this.pinching=!0);return!0}}}},{key:"up",value:function(){if(this.pinching&&this.parent.input.touches.length<=1)return this.active=!1,this.lastCenter=null,this.pinching=!1,this.moved=!1,this.parent.emit("pinch-end",this.parent),!0}}]),e}(g),T={left:!1,right:!1,top:!1,bottom:!1,direction:null,underflow:"center"},O=function(t){function e(t){var i,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return p(this,e),(i=a(this,h(e).call(this,t))).options=Object.assign({},T,n),i.options.direction&&(i.options.left="x"===i.options.direction||"all"===i.options.direction||null,i.options.right="x"===i.options.direction||"all"===i.options.direction||null,i.options.top="y"===i.options.direction||"all"===i.options.direction||null,i.options.bottom="y"===i.options.direction||"all"===i.options.direction||null),i.parseUnderflow(),i.last={x:null,y:null,scaleX:null,scaleY:null},i.update(),i}return c(e,t),v(e,[{key:"parseUnderflow",value:function(){var t=this.options.underflow.toLowerCase();"none"===t?this.noUnderflow=!0:"center"===t?(this.underflowX=this.underflowY=0,this.noUnderflow=!1):(this.underflowX=-1!==t.indexOf("left")?-1:-1!==t.indexOf("right")?1:0,this.underflowY=-1!==t.indexOf("top")?-1:-1!==t.indexOf("bottom")?1:0,this.noUnderflow=!1)}},{key:"move",value:function(){return this.update(),!1}},{key:"update",value:function(){if(!this.paused&&(this.parent.x!==this.last.x||this.parent.y!==this.last.y||this.parent.scale.x!==this.last.scaleX||this.parent.scale.y!==this.last.scaleY)){var t={x:this.parent.x,y:this.parent.y},e=this.parent.plugins.decelerate||{};if(null!==this.options.left||null!==this.options.right){var i=!1;if(this.parent.screenWorldWidth<this.parent.screenWidth){if(!this.noUnderflow)switch(this.underflowX){case-1:0!==this.parent.x&&(this.parent.x=0,i=!0);break;case 1:this.parent.x!==this.parent.screenWidth-this.parent.screenWorldWidth&&(this.parent.x=this.parent.screenWidth-this.parent.screenWorldWidth,i=!0);break;default:this.parent.x!==(this.parent.screenWidth-this.parent.screenWorldWidth)/2&&(this.parent.x=(this.parent.screenWidth-this.parent.screenWorldWidth)/2,i=!0)}}else null!==this.options.left&&this.parent.left<(!0===this.options.left?0:this.options.left)&&(this.parent.x=-(!0===this.options.left?0:this.options.left)*this.parent.scale.x,e.x=0,i=!0),null!==this.options.right&&this.parent.right>(!0===this.options.right?this.parent.worldWidth:this.options.right)&&(this.parent.x=-(!0===this.options.right?this.parent.worldWidth:this.options.right)*this.parent.scale.x+this.parent.screenWidth,e.x=0,i=!0);i&&this.parent.emit("moved",{viewport:this.parent,original:t,type:"clamp-x"})}if(null!==this.options.top||null!==this.options.bottom){var n=!1;if(this.parent.screenWorldHeight<this.parent.screenHeight){if(!this.noUnderflow)switch(this.underflowY){case-1:0!==this.parent.y&&(this.parent.y=0,n=!0);break;case 1:this.parent.y!==this.parent.screenHeight-this.parent.screenWorldHeight&&(this.parent.y=this.parent.screenHeight-this.parent.screenWorldHeight,n=!0);break;default:this.parent.y!==(this.parent.screenHeight-this.parent.screenWorldHeight)/2&&(this.parent.y=(this.parent.screenHeight-this.parent.screenWorldHeight)/2,n=!0)}}else null!==this.options.top&&this.parent.top<(!0===this.options.top?0:this.options.top)&&(this.parent.y=-(!0===this.options.top?0:this.options.top)*this.parent.scale.y,e.y=0,n=!0),null!==this.options.bottom&&this.parent.bottom>(!0===this.options.bottom?this.parent.worldHeight:this.options.bottom)&&(this.parent.y=-(!0===this.options.bottom?this.parent.worldHeight:this.options.bottom)*this.parent.scale.y+this.parent.screenHeight,e.y=0,n=!0);n&&this.parent.emit("moved",{viewport:this.parent,original:t,type:"clamp-y"})}this.last.x=this.parent.x,this.last.y=this.parent.y,this.last.scaleX=this.parent.scale.x,this.last.scaleY=this.parent.scale.y}}},{key:"reset",value:function(){this.update()}}]),e}(g),k={minWidth:null,minHeight:null,maxWidth:null,maxHeight:null},E=function(t){function e(t){var i,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return p(this,e),(i=a(this,h(e).call(this,t))).options=Object.assign({},k,n),i.clamp(),i}return c(e,t),v(e,[{key:"resize",value:function(){this.clamp()}},{key:"clamp",value:function(){if(!this.paused){var t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight;if(null!==this.options.minWidth&&t<this.options.minWidth){var i=this.parent.scale.x;this.parent.fitWidth(this.options.minWidth,!1,!1,!0),this.parent.scale.y*=this.parent.scale.x/i,t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(null!==this.options.maxWidth&&t>this.options.maxWidth){var n=this.parent.scale.x;this.parent.fitWidth(this.options.maxWidth,!1,!1,!0),this.parent.scale.y*=this.parent.scale.x/n,t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(null!==this.options.minHeight&&e<this.options.minHeight){var r=this.parent.scale.y;this.parent.fitHeight(this.options.minHeight,!1,!1,!0),this.parent.scale.x*=this.parent.scale.y/r,t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(null!==this.options.maxHeight&&e>this.options.maxHeight){var s=this.parent.scale.y;this.parent.fitHeight(this.options.maxHeight,!1,!1,!0),this.parent.scale.x*=this.parent.scale.y/s,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}}}},{key:"reset",value:function(){this.clamp()}}]),e}(g),j={friction:.95,bounce:.8,minSpeed:.01},C=function(t){function e(t){var i,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return p(this,e),(i=a(this,h(e).call(this,t))).options=Object.assign({},j,n),i.saved=[],i.reset(),i.parent.on("moved",(function(t){return i.moved(t)})),i}return c(e,t),v(e,[{key:"destroy",value:function(){this.parent}},{key:"down",value:function(){this.saved=[],this.x=this.y=!1}},{key:"isActive",value:function(){return this.x||this.y}},{key:"move",value:function(){if(!this.paused){var t=this.parent.input.count();(1===t||t>1&&!this.parent.plugins.get("pinch"))&&(this.saved.push({x:this.parent.x,y:this.parent.y,time:performance.now()}),this.saved.length>60&&this.saved.splice(0,30))}}},{key:"moved",value:function(t){if(this.saved.length){var e=this.saved[this.saved.length-1];"clamp-x"===t.type?e.x===t.original.x&&(e.x=this.parent.x):"clamp-y"===t.type&&e.y===t.original.y&&(e.y=this.parent.y)}}},{key:"up",value:function(){if(0===this.parent.input.count()&&this.saved.length){var t=performance.now(),e=!0,i=!1,n=void 0;try{for(var r,s=this.saved[Symbol.iterator]();!(e=(r=s.next()).done);e=!0){var o=r.value;if(o.time>=t-100){var a=t-o.time;this.x=(this.parent.x-o.x)/a,this.y=(this.parent.y-o.y)/a,this.percentChangeX=this.percentChangeY=this.options.friction;break}}}catch(t){i=!0,n=t}finally{try{e||null==s.return||s.return()}finally{if(i)throw n}}}}},{key:"activate",value:function(t){void 0!==(t=t||{}).x&&(this.x=t.x,this.percentChangeX=this.options.friction),void 0!==t.y&&(this.y=t.y,this.percentChangeY=this.options.friction)}},{key:"update",value:function(t){var e;this.paused||(this.x&&(this.parent.x+=this.x*t,this.x*=this.percentChangeX,Math.abs(this.x)<this.options.minSpeed&&(this.x=0),e=!0),this.y&&(this.parent.y+=this.y*t,this.y*=this.percentChangeY,Math.abs(this.y)<this.options.minSpeed&&(this.y=0),e=!0),e&&this.parent.emit("moved",{viewport:this.parent,type:"decelerate"}))}},{key:"reset",value:function(){this.x=this.y=null}}]),e}(g),H="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{};var P=function(t,e){return t(e={exports:{}},e.exports),e.exports}((function(t,e){(function(){var e;(function(e){t.exports=e})(e={linear:function(t,e,i,n){return i*t/n+e},easeInQuad:function(t,e,i,n){return i*(t/=n)*t+e},easeOutQuad:function(t,e,i,n){return-i*(t/=n)*(t-2)+e},easeInOutQuad:function(t,e,i,n){return(t/=n/2)<1?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e},easeInCubic:function(t,e,i,n){return i*(t/=n)*t*t+e},easeOutCubic:function(t,e,i,n){return i*((t=t/n-1)*t*t+1)+e},easeInOutCubic:function(t,e,i,n){return(t/=n/2)<1?i/2*t*t*t+e:i/2*((t-=2)*t*t+2)+e},easeInQuart:function(t,e,i,n){return i*(t/=n)*t*t*t+e},easeOutQuart:function(t,e,i,n){return-i*((t=t/n-1)*t*t*t-1)+e},easeInOutQuart:function(t,e,i,n){return(t/=n/2)<1?i/2*t*t*t*t+e:-i/2*((t-=2)*t*t*t-2)+e},easeInQuint:function(t,e,i,n){return i*(t/=n)*t*t*t*t+e},easeOutQuint:function(t,e,i,n){return i*((t=t/n-1)*t*t*t*t+1)+e},easeInOutQuint:function(t,e,i,n){return(t/=n/2)<1?i/2*t*t*t*t*t+e:i/2*((t-=2)*t*t*t*t+2)+e},easeInSine:function(t,e,i,n){return-i*Math.cos(t/n*(Math.PI/2))+i+e},easeOutSine:function(t,e,i,n){return i*Math.sin(t/n*(Math.PI/2))+e},easeInOutSine:function(t,e,i,n){return-i/2*(Math.cos(Math.PI*t/n)-1)+e},easeInExpo:function(t,e,i,n){return 0===t?e:i*Math.pow(2,10*(t/n-1))+e},easeOutExpo:function(t,e,i,n){return t===n?e+i:i*(1-Math.pow(2,-10*t/n))+e},easeInOutExpo:function(t,e,i,n){return(t/=n/2)<1?i/2*Math.pow(2,10*(t-1))+e:i/2*(2-Math.pow(2,-10*--t))+e},easeInCirc:function(t,e,i,n){return-i*(Math.sqrt(1-(t/=n)*t)-1)+e},easeOutCirc:function(t,e,i,n){return i*Math.sqrt(1-(t=t/n-1)*t)+e},easeInOutCirc:function(t,e,i,n){return(t/=n/2)<1?-i/2*(Math.sqrt(1-t*t)-1)+e:i/2*(Math.sqrt(1-(t-=2)*t)+1)+e},easeInElastic:function(t,e,i,n){var r,s,o;return o=1.70158,0===t||(t/=n),(s=0)||(s=.3*n),(r=i)<Math.abs(i)?(r=i,o=s/4):o=s/(2*Math.PI)*Math.asin(i/r),-r*Math.pow(2,10*(t-=1))*Math.sin((t*n-o)*(2*Math.PI)/s)+e},easeOutElastic:function(t,e,i,n){var r,s,o;return o=1.70158,0===t||(t/=n),(s=0)||(s=.3*n),(r=i)<Math.abs(i)?(r=i,o=s/4):o=s/(2*Math.PI)*Math.asin(i/r),r*Math.pow(2,-10*t)*Math.sin((t*n-o)*(2*Math.PI)/s)+i+e},easeInOutElastic:function(t,e,i,n){var r,s,o;return o=1.70158,0===t||(t/=n/2),(s=0)||(s=n*(.3*1.5)),(r=i)<Math.abs(i)?(r=i,o=s/4):o=s/(2*Math.PI)*Math.asin(i/r),t<1?r*Math.pow(2,10*(t-=1))*Math.sin((t*n-o)*(2*Math.PI)/s)*-.5+e:r*Math.pow(2,-10*(t-=1))*Math.sin((t*n-o)*(2*Math.PI)/s)*.5+i+e},easeInBack:function(t,e,i,n,r){return void 0===r&&(r=1.70158),i*(t/=n)*t*((r+1)*t-r)+e},easeOutBack:function(t,e,i,n,r){return void 0===r&&(r=1.70158),i*((t=t/n-1)*t*((r+1)*t+r)+1)+e},easeInOutBack:function(t,e,i,n,r){return void 0===r&&(r=1.70158),(t/=n/2)<1?i/2*(t*t*((1+(r*=1.525))*t-r))+e:i/2*((t-=2)*t*((1+(r*=1.525))*t+r)+2)+e},easeInBounce:function(t,i,n,r){return n-e.easeOutBounce(r-t,0,n,r)+i},easeOutBounce:function(t,e,i,n){return(t/=n)<1/2.75?i*(7.5625*t*t)+e:t<2/2.75?i*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?i*(7.5625*(t-=2.25/2.75)*t+.9375)+e:i*(7.5625*(t-=2.625/2.75)*t+.984375)+e},easeInOutBounce:function(t,i,n,r){return t<r/2?.5*e.easeInBounce(2*t,0,n,r)+i:.5*e.easeOutBounce(2*t-r,0,n,r)+.5*n+i}})}).call(H)}));function M(t,e){return t?"function"==typeof t?t:"string"==typeof t?P[t]:void 0:P[e]}var z={sides:"all",friction:.5,time:150,ease:"easeInOutSine",underflow:"center",bounceBox:null},I=function(t){function e(t){var i,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return p(this,e),(i=a(this,h(e).call(this,t))).options=Object.assign({},z,n),i.ease=M(i.options.ease,"easeInOutSine"),i.options.sides&&("all"===i.options.sides?i.top=i.bottom=i.left=i.right=!0:"horizontal"===i.options.sides?i.right=i.left=!0:"vertical"===i.options.sides?i.top=i.bottom=!0:(i.top=-1!==i.options.sides.indexOf("top"),i.bottom=-1!==i.options.sides.indexOf("bottom"),i.left=-1!==i.options.sides.indexOf("left"),i.right=-1!==i.options.sides.indexOf("right"))),i.parseUnderflow(),i.last={},i.reset(),i}return c(e,t),v(e,[{key:"parseUnderflow",value:function(){var t=this.options.underflow.toLowerCase();"center"===t?(this.underflowX=0,this.underflowY=0):(this.underflowX=-1!==t.indexOf("left")?-1:-1!==t.indexOf("right")?1:0,this.underflowY=-1!==t.indexOf("top")?-1:-1!==t.indexOf("bottom")?1:0)}},{key:"isActive",value:function(){return null!==this.toX||null!==this.toY}},{key:"down",value:function(){this.toX=this.toY=null}},{key:"up",value:function(){this.bounce()}},{key:"update",value:function(t){if(!this.paused){if(this.bounce(),this.toX){var e=this.toX;e.time+=t,this.parent.emit("moved",{viewport:this.parent,type:"bounce-x"}),e.time>=this.options.time?(this.parent.x=e.end,this.toX=null,this.parent.emit("bounce-x-end",this.parent)):this.parent.x=this.ease(e.time,e.start,e.delta,this.options.time)}if(this.toY){var i=this.toY;i.time+=t,this.parent.emit("moved",{viewport:this.parent,type:"bounce-y"}),i.time>=this.options.time?(this.parent.y=i.end,this.toY=null,this.parent.emit("bounce-y-end",this.parent)):this.parent.y=this.ease(i.time,i.start,i.delta,this.options.time)}}}},{key:"calcUnderflowX",value:function(){var t;switch(this.underflowX){case-1:t=0;break;case 1:t=this.parent.screenWidth-this.parent.screenWorldWidth;break;default:t=(this.parent.screenWidth-this.parent.screenWorldWidth)/2}return t}},{key:"calcUnderflowY",value:function(){var t;switch(this.underflowY){case-1:t=0;break;case 1:t=this.parent.screenHeight-this.parent.screenWorldHeight;break;default:t=(this.parent.screenHeight-this.parent.screenWorldHeight)/2}return t}},{key:"oob",value:function(){var t=this.options.bounceBox;if(t){var e=void 0===t.x?0:t.x,i=void 0===t.y?0:t.y,r=void 0===t.width?this.parent.worldWidth:t.width,s=void 0===t.height?this.parent.worldHeight:t.height;return{left:this.parent.left<e,right:this.parent.right>r,top:this.parent.top<i,bottom:this.parent.bottom>s,topLeft:new n.Point(e*this.parent.scale.x,i*this.parent.scale.y),bottomRight:new n.Point(r*this.parent.scale.x-this.parent.screenWidth,s*this.parent.scale.y-this.parent.screenHeight)}}return{left:this.parent.left<0,right:this.parent.right>this.parent.worldWidth,top:this.parent.top<0,bottom:this.parent.bottom>this.parent.worldHeight,topLeft:new n.Point(0,0),bottomRight:new n.Point(this.parent.worldWidth*this.parent.scale.x-this.parent.screenWidth,this.parent.worldHeight*this.parent.scale.y-this.parent.screenHeight)}}},{key:"bounce",value:function(){if(!this.paused){var t,e=this.parent.plugins.get("decelerate");e&&(e.x||e.y)&&(e.x&&e.percentChangeX===e.options.friction||e.y&&e.percentChangeY===e.options.friction)&&(((t=this.oob()).left&&this.left||t.right&&this.right)&&(e.percentChangeX=this.options.friction),(t.top&&this.top||t.bottom&&this.bottom)&&(e.percentChangeY=this.options.friction));var i=this.parent.plugins.get("drag")||{},n=this.parent.plugins.get("pinch")||{};if(e=e||{},!(i.active||n.active||this.toX&&this.toY||e.x&&e.y)){var r=(t=t||this.oob()).topLeft,s=t.bottomRight;if(!this.toX&&!e.x){var o=null;t.left&&this.left?o=this.parent.screenWorldWidth<this.parent.screenWidth?this.calcUnderflowX():-r.x:t.right&&this.right&&(o=this.parent.screenWorldWidth<this.parent.screenWidth?this.calcUnderflowX():-s.x),null!==o&&this.parent.x!==o&&(this.toX={time:0,start:this.parent.x,delta:o-this.parent.x,end:o},this.parent.emit("bounce-x-start",this.parent))}if(!this.toY&&!e.y){var a=null;t.top&&this.top?a=this.parent.screenWorldHeight<this.parent.screenHeight?this.calcUnderflowY():-r.y:t.bottom&&this.bottom&&(a=this.parent.screenWorldHeight<this.parent.screenHeight?this.calcUnderflowY():-s.y),null!==a&&this.parent.y!==a&&(this.toY={time:0,start:this.parent.y,delta:a-this.parent.y,end:a},this.parent.emit("bounce-y-start",this.parent))}}}}},{key:"reset",value:function(){this.toX=this.toY=null,this.bounce()}}]),e}(g),W={topLeft:!1,friction:.8,time:1e3,ease:"easeInOutSine",interrupt:!0,removeOnComplete:!1,removeOnInterrupt:!1,forceStart:!1},A=function(t){function e(t,i,n){var r,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return p(this,e),(r=a(this,h(e).call(this,t))).options=Object.assign({},W,s),r.ease=M(s.ease,"easeInOutSine"),r.x=i,r.y=n,r.options.forceStart&&r.snapStart(),r}return c(e,t),v(e,[{key:"snapStart",value:function(){this.percent=0,this.snapping={time:0};var t=this.options.topLeft?this.parent.corner:this.parent.center;this.deltaX=this.x-t.x,this.deltaY=this.y-t.y,this.startX=t.x,this.startY=t.y,this.parent.emit("snap-start",this.parent)}},{key:"wheel",value:function(){this.options.removeOnInterrupt&&this.parent.plugins.remove("snap")}},{key:"down",value:function(){this.options.removeOnInterrupt?this.parent.plugins.remove("snap"):this.options.interrupt&&(this.snapping=null)}},{key:"up",value:function(){if(0===this.parent.input.count()){var t=this.parent.plugins.get("decelerate");t&&(t.x||t.y)&&(t.percentChangeX=t.percentChangeY=this.options.friction)}}},{key:"update",value:function(t){if(!(this.paused||this.options.interrupt&&0!==this.parent.input.count()))if(this.snapping){var e,i,n,r=this.snapping;if(r.time+=t,r.time>this.options.time)e=!0,i=this.startX+this.deltaX,n=this.startY+this.deltaY;else{var s=this.ease(r.time,0,1,this.options.time);i=this.startX+this.deltaX*s,n=this.startY+this.deltaY*s}this.options.topLeft?this.parent.moveCorner(i,n):this.parent.moveCenter(i,n),this.parent.emit("moved",{viewport:this.parent,type:"snap"}),e&&(this.options.removeOnComplete&&this.parent.plugins.remove("snap"),this.parent.emit("snap-end",this.parent),this.snapping=null)}else{var o=this.options.topLeft?this.parent.corner:this.parent.center;o.x===this.x&&o.y===this.y||this.snapStart()}}}]),e}(g),R={width:0,height:0,time:1e3,ease:"easeInOutSine",center:null,interrupt:!0,removeOnComplete:!1,removeOnInterrupts:!1,forceStart:!1,noMove:!1},L=function(t){function e(t){var i,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return p(this,e),(i=a(this,h(e).call(this,t))).options=Object.assign({},R,n),i.ease=M(i.options.ease),i.options.width>0&&(i.xScale=t.screenWidth/i.options.width),i.options.height>0&&(i.yScale=t.screenHeight/i.options.height),i.xIndependent=!!i.xScale,i.yIndependent=!!i.yScale,i.xScale=i.xIndependent?i.xScale:i.yScale,i.yScale=i.yIndependent?i.yScale:i.xScale,0===i.options.time?(t.container.scale.x=i.xScale,t.container.scale.y=i.yScale,i.options.removeOnComplete&&i.parent.plugins.remove("snap-zoom")):n.forceStart&&i.createSnapping(),i}return c(e,t),v(e,[{key:"createSnapping",value:function(){var t=this.parent.scale;this.snapping={time:0,startX:t.x,startY:t.y,deltaX:this.xScale-t.x,deltaY:this.yScale-t.y},this.parent.emit("snap-zoom-start",this.parent)}},{key:"resize",value:function(){this.snapping=null,this.options.width>0&&(this.xScale=this.parent.screenWidth/this.options.width),this.options.height>0&&(this.yScale=this.parent.screenHeight/this.options.height),this.xScale=this.xIndependent?this.xScale:this.yScale,this.yScale=this.yIndependent?this.yScale:this.xScale}},{key:"wheel",value:function(){this.options.removeOnInterrupt&&this.parent.plugins.remove("snap-zoom")}},{key:"down",value:function(){this.options.removeOnInterrupt?this.parent.plugins.remove("snap-zoom"):this.options.interrupt&&(this.snapping=null)}},{key:"update",value:function(t){var e;if(!this.paused&&(!this.options.interrupt||0===this.parent.input.count()))if(this.options.center||this.options.noMove||(e=this.parent.center),this.snapping){if(this.snapping){var i=this.snapping;if(i.time+=t,i.time>=this.options.time)this.parent.scale.set(this.xScale,this.yScale),this.options.removeOnComplete&&this.parent.plugins.remove("snap-zoom"),this.parent.emit("snap-zoom-end",this.parent),this.snapping=null;else{var n=this.snapping;this.parent.scale.x=this.ease(n.time,n.startX,n.deltaX,this.options.time),this.parent.scale.y=this.ease(n.time,n.startY,n.deltaY,this.options.time)}var r=this.parent.plugins.get("clamp-zoom");r&&r.clamp(),this.options.noMove||(this.options.center?this.parent.moveCenter(this.options.center):this.parent.moveCenter(e))}}else this.parent.scale.x===this.xScale&&this.parent.scale.y===this.yScale||this.createSnapping()}},{key:"resume",value:function(){this.snapping=null,s(h(e.prototype),"resume",this).call(this)}}]),e}(g),D={speed:0,acceleration:null,radius:null},_=function(t){function e(t,i){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return p(this,e),(n=a(this,h(e).call(this,t))).target=i,n.options=Object.assign({},D,r),n.velocity={x:0,y:0},n}return c(e,t),v(e,[{key:"update",value:function(t){if(!this.paused){var e=this.parent.center,i=this.target.x,n=this.target.y;if(this.options.radius){if(!(Math.sqrt(Math.pow(this.target.y-e.y,2)+Math.pow(this.target.x-e.x,2))>this.options.radius))return;var r=Math.atan2(this.target.y-e.y,this.target.x-e.x);i=this.target.x-Math.cos(r)*this.options.radius,n=this.target.y-Math.sin(r)*this.options.radius}var s=i-e.x,o=n-e.y;if(s||o)if(this.options.speed)if(this.options.acceleration){var a=Math.atan2(n-e.y,i-e.x),l=Math.sqrt(Math.pow(s,2)+Math.pow(o,2));if(l){var h=(Math.pow(this.velocity.x,2)+Math.pow(this.velocity.y,2))/(2*this.options.acceleration);this.velocity=l>h?{x:Math.min(this.velocity.x+this.options.acceleration*t,this.options.speed),y:Math.min(this.velocity.y+this.options.acceleration*t,this.options.speed)}:{x:Math.max(this.velocity.x-this.options.acceleration*this.options.speed,0),y:Math.max(this.velocity.y-this.options.acceleration*this.options.speed,0)};var c=Math.cos(a)*this.velocity.x,u=Math.sin(a)*this.velocity.y,p=Math.abs(c)>Math.abs(s)?i:e.x+c,d=Math.abs(u)>Math.abs(o)?n:e.y+u;this.parent.moveCenter(p,d),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}}else{var v=Math.atan2(n-e.y,i-e.x),f=Math.cos(v)*this.options.speed,y=Math.sin(v)*this.options.speed,m=Math.abs(f)>Math.abs(s)?i:e.x+f,g=Math.abs(y)>Math.abs(o)?n:e.y+y;this.parent.moveCenter(m,g),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}else this.parent.moveCenter(i,n),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}}}]),e}(g),B={percent:.1,smooth:!1,interrupt:!0,reverse:!1,center:null},Y=function(t){function e(t){var i,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return p(this,e),(i=a(this,h(e).call(this,t))).options=Object.assign({},B,n),i}return c(e,t),v(e,[{key:"down",value:function(){this.options.interrupt&&(this.smoothing=null)}},{key:"update",value:function(){if(this.smoothing){var t,e=this.smoothingCenter,i=this.smoothing;this.options.center||(t=this.parent.toLocal(e)),this.parent.scale.x+=i.x,this.parent.scale.y+=i.y,this.parent.emit("zoomed",{viewport:this.parent,type:"wheel"});var n=this.parent.plugins.get("clamp-zoom");if(n&&n.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{var r=this.parent.toGlobal(t);this.parent.x+=e.x-r.x,this.parent.y+=e.y-r.y}this.smoothingCount++,this.smoothingCount>=this.options.smooth&&(this.smoothing=null)}}},{key:"wheel",value:function(t){if(!this.paused){var e=this.parent.input.getPointerPosition(t),i=(this.options.reverse?-1:1)*-t.deltaY*(t.deltaMode?120:1)/500,n=Math.pow(2,(1+this.options.percent)*i);if(this.options.smooth){var r={x:this.smoothing?this.smoothing.x*(this.options.smooth-this.smoothingCount):0,y:this.smoothing?this.smoothing.y*(this.options.smooth-this.smoothingCount):0};this.smoothing={x:((this.parent.scale.x+r.x)*n-this.parent.scale.x)/this.options.smooth,y:((this.parent.scale.y+r.y)*n-this.parent.scale.y)/this.options.smooth},this.smoothingCount=0,this.smoothingCenter=e}else{var s;this.options.center||(s=this.parent.toLocal(e)),this.parent.scale.x*=n,this.parent.scale.y*=n,this.parent.emit("zoomed",{viewport:this.parent,type:"wheel"});var o=this.parent.plugins.get("clamp-zoom");if(o&&o.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{var a=this.parent.toGlobal(s);this.parent.x+=e.x-a.x,this.parent.y+=e.y-a.y}}return this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.parent.emit("wheel",{wheel:{dx:t.deltaX,dy:t.deltaY,dz:t.deltaZ},event:t,viewport:this.parent}),!this.parent.options.passiveWheel||void 0}}}]),e}(g),N={radius:null,distance:null,top:null,bottom:null,left:null,right:null,speed:8,reverse:!1,noDecelerate:!1,linear:!1,allowButtons:!1},X=function(t){function e(t){var i,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return p(this,e),(i=a(this,h(e).call(this,t))).options=Object.assign({},N,n),i.reverse=i.options.reverse?1:-1,i.radiusSquared=Math.pow(i.options.radius,2),i.resize(),i}return c(e,t),v(e,[{key:"resize",value:function(){var t=this.options.distance;null!==t?(this.left=t,this.top=t,this.right=this.parent.worldScreenWidth-t,this.bottom=this.parent.worldScreenHeight-t):this.radius||(this.left=this.options.left,this.top=this.options.top,this.right=null===this.options.right?null:this.parent.worldScreenWidth-this.options.right,this.bottom=null===this.options.bottom?null:this.parent.worldScreenHeight-this.options.bottom)}},{key:"down",value:function(){this.options.allowButtons||(this.horizontal=this.vertical=null)}},{key:"move",value:function(t){if(!("mouse"!==t.data.pointerType&&1!==t.data.identifier||!this.options.allowButtons&&0!==t.data.buttons)){var e=t.data.global.x,i=t.data.global.y;if(this.radiusSquared){var n=this.parent.toScreen(this.parent.center);if(Math.pow(n.x-e,2)+Math.pow(n.y-i,2)>=this.radiusSquared){var r=Math.atan2(n.y-i,n.x-e);this.options.linear?(this.horizontal=Math.round(Math.cos(r))*this.options.speed*this.reverse*.06,this.vertical=Math.round(Math.sin(r))*this.options.speed*this.reverse*.06):(this.horizontal=Math.cos(r)*this.options.speed*this.reverse*.06,this.vertical=Math.sin(r)*this.options.speed*this.reverse*.06)}else this.horizontal&&this.decelerateHorizontal(),this.vertical&&this.decelerateVertical(),this.horizontal=this.vertical=0}else null!==this.left&&e<this.left?this.horizontal=1*this.reverse*this.options.speed*.06:null!==this.right&&e>this.right?this.horizontal=-1*this.reverse*this.options.speed*.06:(this.decelerateHorizontal(),this.horizontal=0),null!==this.top&&i<this.top?this.vertical=1*this.reverse*this.options.speed*.06:null!==this.bottom&&i>this.bottom?this.vertical=-1*this.reverse*this.options.speed*.06:(this.decelerateVertical(),this.vertical=0)}}},{key:"decelerateHorizontal",value:function(){var t=this.parent.plugins.get("decelerate");this.horizontal&&t&&!this.options.noDecelerate&&t.activate({x:this.horizontal*this.options.speed*this.reverse/(1e3/60)})}},{key:"decelerateVertical",value:function(){var t=this.parent.plugins.get("decelerate");this.vertical&&t&&!this.options.noDecelerate&&t.activate({y:this.vertical*this.options.speed*this.reverse/(1e3/60)})}},{key:"up",value:function(){this.horizontal&&this.decelerateHorizontal(),this.vertical&&this.decelerateVertical(),this.horizontal=this.vertical=null}},{key:"update",value:function(){if(!this.paused&&(this.horizontal||this.vertical)){var t=this.parent.center;this.horizontal&&(t.x+=this.horizontal*this.options.speed),this.vertical&&(t.y+=this.vertical*this.options.speed),this.parent.moveCenter(t),this.parent.emit("moved",{viewport:this.parent,type:"mouse-edges"})}}}]),e}(g),F={screenWidth:window.innerWidth,screenHeight:window.innerHeight,worldWidth:null,worldHeight:null,threshold:5,passiveWheel:!0,stopPropagation:!1,forceHitArea:null,noTicker:!1,interaction:null,disableOnContextMenu:!1},V=function(t){function e(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(p(this,e),(t=a(this,h(e).call(this))).options=Object.assign({},F,i),i.ticker)t.options.ticker=i.ticker;else{var r,s=n;r=parseInt(/^(\d+)\./.exec(n.VERSION)[1])<5?s.ticker.shared:s.Ticker.shared,t.options.ticker=i.ticker||r}return t.screenWidth=t.options.screenWidth,t.screenHeight=t.options.screenHeight,t._worldWidth=t.options.worldWidth,t._worldHeight=t.options.worldHeight,t.forceHitArea=t.options.forceHitArea,t.threshold=t.options.threshold,t.options.divWheel=t.options.divWheel||document.body,t.options.disableOnContextMenu&&(t.options.divWheel.oncontextmenu=function(t){return t.preventDefault()}),t.options.noTicker||(t.tickerFunction=function(){return t.update(t.options.ticker.elapsedMS)},t.options.ticker.add(t.tickerFunction)),t.input=new f(l(t)),t.plugins=new m(l(t)),t}return c(e,t),v(e,[{key:"destroy",value:function(t){this.options.noTicker||this.options.ticker.remove(this.tickerFunction),this.input.destroy(),s(h(e.prototype),"destroy",this).call(this,t)}},{key:"update",value:function(t){this.pause||(this.plugins.update(t),this.lastViewport&&(this.lastViewport.x!==this.x||this.lastViewport.y!==this.y?this.moving=!0:this.moving&&(this.emit("moved-end",this),this.moving=!1),this.lastViewport.scaleX!==this.scale.x||this.lastViewport.scaleY!==this.scale.y?this.zooming=!0:this.zooming&&(this.emit("zoomed-end",this),this.zooming=!1)),this.forceHitArea||(this._hitAreaDefault=new n.Rectangle(this.left,this.top,this.worldScreenWidth,this.worldScreenHeight),this.hitArea=this._hitAreaDefault),this._dirty=this._dirty||!this.lastViewport||this.lastViewport.x!==this.x||this.lastViewport.y!==this.y||this.lastViewport.scaleX!==this.scale.x||this.lastViewport.scaleY!==this.scale.y,this.lastViewport={x:this.x,y:this.y,scaleX:this.scale.x,scaleY:this.scale.y},this.emit("frame-end",this))}},{key:"resize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.innerWidth,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.innerHeight,i=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;this.screenWidth=t,this.screenHeight=e,void 0!==i&&(this._worldWidth=i),void 0!==n&&(this._worldHeight=n),this.plugins.resize()}},{key:"getVisibleBounds",value:function(){return new n.Rectangle(this.left,this.top,this.worldScreenWidth,this.worldScreenHeight)}},{key:"toWorld",value:function(t,e){return 2===arguments.length?this.toLocal(new n.Point(t,e)):this.toLocal(t)}},{key:"toScreen",value:function(t,e){return 2===arguments.length?this.toGlobal(new n.Point(t,e)):this.toGlobal(t)}},{key:"moveCenter",value:function(){var t,e;return isNaN(arguments[0])?(t=arguments[0].x,e=arguments[0].y):(t=arguments[0],e=arguments[1]),this.position.set((this.worldScreenWidth/2-t)*this.scale.x,(this.worldScreenHeight/2-e)*this.scale.y),this.plugins.reset(),this.dirty=!0,this}},{key:"moveCorner",value:function(t,e){return 1===arguments.length?this.position.set(-t.x*this.scale.x,-t.y*this.scale.y):this.position.set(-t*this.scale.x,-e*this.scale.y),this.plugins.reset(),this}},{key:"fitWidth",value:function(t,e){var i,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3?arguments[3]:void 0;e&&(i=this.center),this.scale.x=this.screenWidth/t,n&&(this.scale.y=this.scale.x);var s=this.plugins.get("clamp-zoom");return!r&&s&&s.clamp(),e&&this.moveCenter(i),this}},{key:"fitHeight",value:function(t,e){var i,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3?arguments[3]:void 0;e&&(i=this.center),this.scale.y=this.screenHeight/t,n&&(this.scale.x=this.scale.y);var s=this.plugins.get("clamp-zoom");return!r&&s&&s.clamp(),e&&this.moveCenter(i),this}},{key:"fitWorld",value:function(t){var e;t&&(e=this.center),this.scale.x=this.screenWidth/this.worldWidth,this.scale.y=this.screenHeight/this.worldHeight,this.scale.x<this.scale.y?this.scale.y=this.scale.x:this.scale.x=this.scale.y;var i=this.plugins.get("clamp-zoom");return i&&i.clamp(),t&&this.moveCenter(e),this}},{key:"fit",value:function(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.worldWidth,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.worldHeight;t&&(e=this.center),this.scale.x=this.screenWidth/i,this.scale.y=this.screenHeight/n,this.scale.x<this.scale.y?this.scale.y=this.scale.x:this.scale.x=this.scale.y;var r=this.plugins.get("clamp-zoom");return r&&r.clamp(),t&&this.moveCenter(e),this}},{key:"setZoom",value:function(t,e){var i;e&&(i=this.center),this.scale.set(t);var n=this.plugins.get("clamp-zoom");return n&&n.clamp(),e&&this.moveCenter(i),this}},{key:"zoomPercent",value:function(t,e){return this.setZoom(this.scale.x+this.scale.x*t,e)}},{key:"zoom",value:function(t,e){return this.fitWidth(t+this.worldScreenWidth,e),this}},{key:"snapZoom",value:function(t){return this.plugins.add("snap-zoom",new L(this,t)),this}},{key:"OOB",value:function(){return{left:this.left<0,right:this.right>this.worldWidth,top:this.top<0,bottom:this.bottom>this._worldHeight,cornerPoint:new n.Point(this.worldWidth*this.scale.x-this.screenWidth,this.worldHeight*this.scale.y-this.screenHeight)}}},{key:"drag",value:function(t){return this.plugins.add("drag",new w(this,t)),this}},{key:"clamp",value:function(t){return this.plugins.add("clamp",new O(this,t)),this}},{key:"decelerate",value:function(t){return this.plugins.add("decelerate",new C(this,t)),this}},{key:"bounce",value:function(t){return this.plugins.add("bounce",new I(this,t)),this}},{key:"pinch",value:function(t){return this.plugins.add("pinch",new S(this,t)),this}},{key:"snap",value:function(t,e,i){return this.plugins.add("snap",new A(this,t,e,i)),this}},{key:"follow",value:function(t,e){return this.plugins.add("follow",new _(this,t,e)),this}},{key:"wheel",value:function(t){return this.plugins.add("wheel",new Y(this,t)),this}},{key:"clampZoom",value:function(t){return this.plugins.add("clamp-zoom",new E(this,t)),this}},{key:"mouseEdges",value:function(t){return this.plugins.add("mouse-edges",new X(this,t)),this}},{key:"ensureVisible",value:function(t,e,i,n){t<this.left?this.left=t:t+i>this.right&&(this.right=t+i),e<this.top?this.top=e:e+n>this.bottom&&(this.bottom=e+n)}},{key:"worldWidth",get:function(){return this._worldWidth?this._worldWidth:this.width/this.scale.x},set:function(t){this._worldWidth=t,this.plugins.resize()}},{key:"worldHeight",get:function(){return this._worldHeight?this._worldHeight:this.height/this.scale.y},set:function(t){this._worldHeight=t,this.plugins.resize()}},{key:"worldScreenWidth",get:function(){return this.screenWidth/this.scale.x}},{key:"worldScreenHeight",get:function(){return this.screenHeight/this.scale.y}},{key:"screenWorldWidth",get:function(){return this.worldWidth*this.scale.x}},{key:"screenWorldHeight",get:function(){return this.worldHeight*this.scale.y}},{key:"center",get:function(){return new n.Point(this.worldScreenWidth/2-this.x/this.scale.x,this.worldScreenHeight/2-this.y/this.scale.y)},set:function(t){this.moveCenter(t)}},{key:"corner",get:function(){return new n.Point(-this.x/this.scale.x,-this.y/this.scale.y)},set:function(t){this.moveCorner(t)}},{key:"scaled",set:function(t){this.setZoom(t,!0)},get:function(){return this.scale.x}},{key:"right",get:function(){return-this.x/this.scale.x+this.worldScreenWidth},set:function(t){this.x=-t*this.scale.x+this.screenWidth,this.plugins.reset()}},{key:"left",get:function(){return-this.x/this.scale.x},set:function(t){this.x=-t*this.scale.x,this.plugins.reset()}},{key:"top",get:function(){return-this.y/this.scale.y},set:function(t){this.y=-t*this.scale.y,this.plugins.reset()}},{key:"bottom",get:function(){return-this.y/this.scale.y+this.worldScreenHeight},set:function(t){this.y=-t*this.scale.y+this.screenHeight,this.plugins.reset()}},{key:"dirty",get:function(){return this._dirty},set:function(t){this._dirty=t}},{key:"forceHitArea",get:function(){return this._forceHitArea},set:function(t){t?(this._forceHitArea=t,this.hitArea=t):(this._forceHitArea=null,this.hitArea=new n.Rectangle(0,0,this.worldWidth,this.worldHeight))}},{key:"pause",get:function(){return this._pause},set:function(t){this._pause=t,this.lastViewport=null,this.moving=!1,this.zooming=!1,t&&this.input.pause()}}]),e}(n.Container)}).call(this,i(78))},412:function(t,e,i){"use strict";i.r(e);var n=i(10),r=i(1),s=i.n(r),o=i(261),a=i(4),l=function(){function t(t,e){this._base=t,this._tileSize=null,this.usingHitmap=!0,t.texture=o.Texture.EMPTY,this.disasterGameIndex=e,t.disasterGameIndex=e,this.handleTextureResize=this.handleTextureResize.bind(this),t.anchor=new o.Point(0,1)}return t.prototype.getBaseObject=function(){return this._base},Object.defineProperty(t.prototype,"tileSize",{get:function(){return this._tileSize},set:function(t){this._tileSize=t,this.handleTextureResize()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"base",{get:function(){return this._base},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"visible",{get:function(){return this._base.visible},set:function(t){this._base.visible=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"x",{get:function(){return this._base.x},set:function(t){this._base.x=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._base.y},set:function(t){this._base.y=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"texture",{get:function(){return this._base.texture},set:function(t){null!=t?(this._base.texture.off("update",this.handleTextureResize),this._base.texture=t,this._base.texture.on("update",this.handleTextureResize),(this.usingHitmap&&void 0===t.baseTexture.hitmap||void 0===t.baseTexture.averageHue)&&Object(a.c)(t.baseTexture,127),this.handleTextureResize(!1)):this._base.texture=o.Texture.EMPTY},enumerable:!0,configurable:!0}),t.prototype.setInteractive=function(t){this._base.interactive=t},t.prototype.handleTextureResize=function(t){null!=this.tileSize&&(this._base.width=this.tileSize,this._base.scale.y=this._base.scale.x,this.setInteractive(this._base.interactive))},t}(),h=new o.Point;o.Sprite.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,h);var e=this._texture.orig.width,i=this._texture.orig.height,n=-e*this.anchor.x,r=0,s=!1;if(h.x>=n&&h.x<n+e&&(r=-i*this.anchor.y,h.y>=r&&h.y<r+i&&(s=!0)),!s)return!1;var o=this.texture,a=this.texture.baseTexture,l=a.resolution;if(!a.hitmap)return!0;var c=a.hitmap,u=Math.round((h.x-n+o.frame.x)*l)+Math.round((h.y-r+o.frame.y)*l)*a.realWidth,p=u%32;return 0!=(c[u/32|0]&1<<p)};var c={_queuedRender:!1,queueRender:function(){c._queuedRender=!0},needsRender:function(){return c._queuedRender||c.activeAnimations.size>0},activeAnimations:new Set},u=c,p=i(11);var d=function(t){function e(e,i,n){var r=t.call(this)||this;r.getTexture=i,r.disasterGameIndex=e,r.interactive=!0,r.interactiveChildren=!0,r.tileObject=new l(new o.Sprite,e),r.tileObject.base.name="tilemain"+e,r.tileObject.base.interactive=!0;var s=r.onForwardEvent.bind(r,"pick");r.tileObject.base.on("touchstart",r.handleTouchEvent),r.tileObject.base.on("touchmove",r.handleTouchEvent),r.tileObject.base.on("touchend",(function(t){var e=[];e[0]=r.lastTouch,t.data.originalEvent=Object.create(t.data.originalEvent,{touches:{value:e}}),s(t)})),r.tileObject.base.on("click",s),r.tileObject.base.on("mouseover",r.onForwardEvent.bind(r,"hoverin")),r.tileObject.base.on("mouseout",r.onForwardEvent.bind(r,"hoverout")),r.tileObject.base.on("mousemove",r.onForwardEvent.bind(r,"hovermove")),r.tileObject.base.zIndex=0,r.addChild(r.tileObject.base),r.tileRiskLevel=new l(new o.Sprite,e),r.tileRiskLevel.usingHitmap=!1,r.tileRiskLevel.setInteractive(!1),r.tileRiskLevel.base.zIndex=0,r.tileRiskLevel.visible=!0,r.tileRiskLevel.base.tint=16711680,r.addChild(r.tileRiskLevel.base),r.tileHoverObject=new l(new o.Sprite,e),r.tileHoverObject.setInteractive(!1),r.tileHoverObject.base.zIndex=0,r.tileHoverObject.visible=!1,r.tileSelectionHighlight=new l(new o.Sprite,e),r.tileSelectionHighlight.setInteractive(!1),r.tileSelectionHighlight.base.zIndex=0,r.tileSelectionHighlight.base.tint=10027263,r.tileSelectionHighlight.visible=!1,r.addChild(r.tileSelectionHighlight.base),r.slant=null,r.addChild(r.tileHoverObject.base),r.numPeople=0,r.tileBuildingObject=new l(new o.Sprite,e),r.tileBuildingObject.usingHitmap=!1,r.tileBuildingObject.base.name="tileBuilding"+e,r.tileBuildingObject.setInteractive(!1),r.tileBuildingObject.base.hitArea=new o.Rectangle(0,0,0,0),r.tileBuildingObject.base.zIndex=0,r.addChild(r.tileBuildingObject.base),r.tileAnimation=new l(new o.AnimatedSprite([o.Texture.EMPTY],!0),e),r.tileAnimation.usingHitmap=!1,r.tileAnimation.base.textures=n,r.tileAnimation.setInteractive(!1),r.tileAnimation.base.zIndex=0,r.tileAnimation.base.hitArea=new o.Rectangle(0,0,0,0),r.tileAnimation.base.animationSpeed=.5,r.tileAnimation.base.loop=!1,r.tileAnimation.base.onComplete=function(){r.tileAnimation.visible=!1,u.activeAnimations.delete(r.tileAnimation),u.queueRender()},r.tileAnimation.base.visible=!1,r.addChild(r.tileAnimation.base);var a=new o.Graphics;r.addChild(a),a.position.x=0,a.position.y=0,a.pivot.x=0,a.pivot.y=0,a.cacheAsBitmap=!0,a.zIndex=0,a.interactive=!1,a.drawPolygon=r.myDrawPolygon,r.tileLeftObject=a;var h=new o.Graphics;return r.addChild(h),h.position.x=0,h.position.y=0,h.pivot.x=0,h.pivot.y=0,h.cacheAsBitmap=!0,h.zIndex=0,h.interactive=!1,h.drawPolygon=r.myDrawPolygon,r.tileRightObject=h,r}return Object(n.c)(e,t),Object.defineProperty(e.prototype,"numPeople",{get:function(){return this.people.length},set:function(t){var e=this;if(void 0!==this.people&&this.people.forEach((function(t){return e.removeChild(t)})),this.people=[],t>0){for(var i=this.getTexture("sprites/person.png"),n=0;n<t;n++)this.people[n]=new o.Sprite(i),this.people[n].anchor=new o.Point(.5,1),this.addChild(this.people[n]);this.repositionPeople()}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tileSideHue",{get:function(){return this._tileSideHue},set:function(t){this._tileSideHue=t,this.redrawTileSides()},enumerable:!0,configurable:!0}),e.prototype.getOverlayTexture=function(){return null==this.slant?this.getTexture(p.j.noSlope):this.getTexture(p.j[this.slant])},Object.defineProperty(e.prototype,"slant",{get:function(){return this._slant},set:function(t){this._slant=t,this.redrawTileSides(),this.tileRiskLevel.texture=this.getOverlayTexture(),this.tileHoverObject.texture=this.getOverlayTexture(),this.tileSelectionHighlight.texture=this.getOverlayTexture()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hoverVisible",{get:function(){return this.tileHoverObject.visible},set:function(t){this.tileHoverObject.visible=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tileSize",{get:function(){return this._tileSize},set:function(t){this._tileSize=t,this.tileObject.tileSize=t,this.tileHoverObject.tileSize=t,this.tileSelectionHighlight.tileSize=t,this.tileAnimation.tileSize=t,this.tileRiskLevel.tileSize=.95*t,"object"==typeof this.tileBuildingObject&&(this.tileBuildingObject.tileSize=t),this.repositionPeople(),"number"==typeof t&&(this.repositionTiles(),this.redrawTileSides())},enumerable:!0,configurable:!0}),e.prototype.repositionPeople=function(){var t=this;this.people.forEach((function(e){e.width=t.tileSize/20,e.scale.y=e.scale.x;var i=Object(a.d)(.5,.9);e.x=i*t.tileSize,e.y=(1-.55*(i-.5))*t.tileSize}))},e.prototype.repositionTiles=function(){this.tileObject.x=0,this.tileObject.y=1*this.tileSize,this.tileHoverObject.x=0,this.tileHoverObject.y=1*this.tileSize,this.tileAnimation.x=0,this.tileSelectionHighlight.x=0,this.tileSelectionHighlight.y=1*this.tileSize,this.tileAnimation.y=1*this.tileSize,"object"==typeof this.tileBuildingObject&&(this.tileBuildingObject.x=0,this.tileBuildingObject.y=1*this.tileSize),this.tileRiskLevel.x=(1-.95)*this.tileSize/2,this.tileRiskLevel.y=.9875*this.tileSize,this.repositionPeople()},e.prototype.redrawTileSides=function(){if("object"==typeof this.tileLeftObject){this.tileLeftObject.cacheAsBitmap=!1,this.tileLeftObject.clear();var t=Object(a.a)(this.tileSideHue/360,68.6/100,.35);this.leftColor=Object(a.k)(t),this.tileLeftObject.beginFill(this.leftColor);var e=[0*this.tileSize,.5*this.tileSize,.5*this.tileSize,0*this.tileSize];null==this.slant||this.slant==p.g.NortheastSouthwest?this.tileLeftObject.drawPolygon([new o.Point(e[0],.75*this.tileSize),new o.Point(e[1],1*this.tileSize),new o.Point(e[2],1.5*this.tileSize),new o.Point(e[3],1.25*this.tileSize)]):this.slant==p.g.SouthwestNortheast?this.tileLeftObject.drawPolygon([new o.Point(e[0],.625*this.tileSize),new o.Point(e[1],.875*this.tileSize),new o.Point(e[2],1.375*this.tileSize),new o.Point(e[3],1.125*this.tileSize)]):this.slant==p.g.NorthwestSoutheast?this.tileLeftObject.drawPolygon([new o.Point(e[0],.625*this.tileSize),new o.Point(e[1],1*this.tileSize),new o.Point(e[2],1.5*this.tileSize),new o.Point(e[3],1.125*this.tileSize)]):this.slant==p.g.SoutheastNorthwest&&this.tileLeftObject.drawPolygon([new o.Point(e[0],.75*this.tileSize),new o.Point(e[1],.875*this.tileSize),new o.Point(e[2],1.375*this.tileSize),new o.Point(e[3],1.25*this.tileSize)]),this.tileLeftObject.endFill(),this.tileLeftObject.cacheAsBitmap=!0}if("object"==typeof this.tileRightObject){this.tileRightObject.cacheAsBitmap=!0,this.tileRightObject.clear();t=Object(a.a)(this.tileSideHue/360,.679,.28);this.rightColor=Object(a.k)(t),this.tileRightObject.beginFill(this.rightColor);var i=[1*this.tileSize,.5*this.tileSize,.5*this.tileSize,1*this.tileSize];null==this.slant||this.slant==p.g.NorthwestSoutheast?this.tileRightObject.drawPolygon([new o.Point(i[0],.75*this.tileSize),new o.Point(i[1],1*this.tileSize),new o.Point(i[2],1.5*this.tileSize),new o.Point(i[3],1.25*this.tileSize)]):this.slant==p.g.SouthwestNortheast?this.tileRightObject.drawPolygon([new o.Point(i[0],.75*this.tileSize),new o.Point(i[1],.875*this.tileSize),new o.Point(i[2],1.375*this.tileSize),new o.Point(i[3],1.25*this.tileSize)]):this.slant==p.g.NortheastSouthwest?this.tileRightObject.drawPolygon([new o.Point(i[0],.625*this.tileSize),new o.Point(i[1],1*this.tileSize),new o.Point(i[2],1.5*this.tileSize),new o.Point(i[3],1.125*this.tileSize)]):this.slant==p.g.SoutheastNorthwest&&this.tileRightObject.drawPolygon([new o.Point(i[0],.625*this.tileSize),new o.Point(i[1],.875*this.tileSize),new o.Point(i[2],1.375*this.tileSize),new o.Point(i[3],1.125*this.tileSize)]),this.tileRightObject.endFill(),this.tileRightObject.cacheAsBitmap=!1}},e.prototype.onForwardEvent=function(t,e){this.emit(t,e)},e.prototype.triggerExplosion=function(){var t=this;return new Promise((function(e){Object(a.i)("audio/explosion.mp3",(function(){t.tileAnimation.visible=!0,u.activeAnimations.add(t.tileAnimation),t.tileAnimation.base.gotoAndPlay(0),e()}),!1)}))},e.prototype.handleTouchEvent=function(t){var e=t.data.originalEvent;this.lastTouch=e.touches[0],e.preventDefault()},e.prototype.myDrawPolygon=function(t){return t.forEach((function(t,e){t.x=Math.trunc(t.x),t.y=Math.trunc(t.y)})),o.Graphics.prototype.drawPolygon.apply(this,arguments),this},e}(o.Container),v=function(){function t(t){this.stateHolder=t,this.plugins=["drag","pinch","wheel","mouseEdges"],this.previousHoveredObject=null,this._interactionAllowed=!1,this.loadedSprites=[],this.tileObjects=[],this.topLevelOrderChanged=!0,this.lastTileMap=null,this.lastRowLength=0,this.currentlyHoveredTile=-1,this.currentlySelectedTile=-1,this.explosionSprites=function(){for(var t=[],e=1;e<=16;e++)t.push("sprites/dynamite/256_00"+Object(a.h)(e,2)+".png");return t}(),this.onPickTile=this.onPickTile.bind(this),this.onHoverInTile=this.onHoverInTile.bind(this),this.onHoverOutTile=this.onHoverOutTile.bind(this),this.onHoverMoveTile=this.onHoverMoveTile.bind(this),this.updateTile=this.updateTile.bind(this),this.getTexture=this.getTexture.bind(this),this.isPinching=!1}return Object.defineProperty(t.prototype,"interactionAllowed",{get:function(){return this._interactionAllowed},set:function(t){this._interactionAllowed=t,this.onHoverOutTile(null),this.clearSelectedTile(null),this.rootObject.emit("disaster-hover",{interactionAllowed:this._interactionAllowed}),null!=this.tileObjects&&this.tileObjects.forEach((function(e){return e.tileObject.base.cursor=t?"pointer":"default"}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tileRiskLevelVisible",{get:function(){return void 0!==this.tileObjects[0]&&this.tileObjects[0].tileRiskLevel.visible},set:function(t){this.tileObjects.forEach((function(e){return e.tileRiskLevel.visible=t})),this.rootObject.emit("disaster-hover",{tileRiskLevelVisible:t})},enumerable:!0,configurable:!0}),t.prototype.onTileChange=function(t){"function"==typeof this.stateHolder.onTileChange&&this.stateHolder.onTileChange(t)},t.getTileIndex=function(t){if("number"!=typeof t.disasterGameIndex)throw new Error("Not a tile-based object");return t.disasterGameIndex},t.prototype.isDragging=function(){return this.rootObject.plugins.get("drag").active||this.rootObject.plugins.get("pinch").active||this.isPinching},t.prototype.shouldIgnoreTileInteraction=function(){return this.isDragging()||-1!=this.currentlySelectedTile||!this.interactionAllowed||void 0!==window.event&&1==window.event.disasterIgnore},t.prototype.clearSelectedTile=function(t){-1!=this.currentlySelectedTile&&(this.currentlyHoveredTile!=this.currentlySelectedTile&&(this.tileObjects[this.currentlySelectedTile].hoverVisible=!1,-1!=this.currentlyHoveredTile&&(this.tileObjects[this.currentlyHoveredTile].hoverVisible=!0),u.queueRender()),this.currentlySelectedTile=-1,-1!=this.currentlyHoveredTile&&"object"==typeof t&&this.onHoverMoveTile(t),this.rootObject.emit("disaster-hover",{currentlySelectedTile:null}))},t.prototype.onPickTile=function(e){this.shouldIgnoreTileInteraction()||1==e.data.originalEvent.disasterIgnore||(this.rootObject.emit("disaster-tilepicked",{currentlySelectedTile:this.lastTileMap[t.getTileIndex(e.target)]}),e.doIgnoreTileClick=!0,u.queueRender())},t.retrieveEventCoords=function(t){if(void 0!==t.clientX){var e=t;return{x:e.clientX,y:e.clientY}}if(void 0!==t.touches){var i=t;return{x:i.touches[0].clientX,y:i.touches[0].clientY}}return console.error("Unexpected event type"),{x:0,y:0}},t.prototype.clearPreviousHover=function(){null!=this.previousHoveredObject&&(this.previousHoveredObject.hoverVisible=!1,this.previousHoveredObject=null)},t.prototype.onHoverInTile=function(e){var i=e.target;if(this.currentlyHoveredTile=t.getTileIndex(i),this.shouldIgnoreTileInteraction()||(this.clearPreviousHover(),this.tileObjects[this.currentlyHoveredTile].hoverVisible=!0,this.previousHoveredObject=this.tileObjects[this.currentlyHoveredTile],u.queueRender()),void 0!==e.data&&null!=this.lastTileMap){var n=t.retrieveEventCoords(e.data.originalEvent);this.interactionAllowed&&this.rootObject.emit("disaster-hover",{hoverX:n.x,hoverY:n.y,currentlyHoveredTile:this.lastTileMap[this.currentlyHoveredTile]})}},t.prototype.onHoverMoveTile=function(e){if(-1!=this.currentlyHoveredTile&&-1==this.currentlySelectedTile&&this.interactionAllowed){var i=t.retrieveEventCoords(e.data.originalEvent);this.rootObject.emit("disaster-hover",{hoverX:i.x,hoverY:i.y,currentlyHoveredTile:this.lastTileMap[this.currentlyHoveredTile]})}},t.prototype.onHoverOutTile=function(t){this.isDragging()||(void 0!==this.tileObjects[this.currentlyHoveredTile]&&this.currentlyHoveredTile!=this.currentlySelectedTile&&(this.clearPreviousHover(),this.tileObjects[this.currentlyHoveredTile].hoverVisible=!1,u.queueRender()),this.currentlyHoveredTile=-1,null!=t&&this.interactionAllowed&&this.rootObject.emit("disaster-hover",{hoverX:0,hoverY:0,currentlyHoveredTile:null}))},t.prototype.setupObjects=function(){var t=this;this.loadedExplosionTextures=this.explosionSprites.map((function(e){return t.getTexture(e)})),this.onHoverOutTile(null),this.rootObject.on("zoomed-end",(function(){u.queueRender()})),this.rootObject.on("pinch-start",(function(){return t.isPinching=!0})),this.rootObject.on("pinch-end",(function(){t.isPinching=!1,window.event.disasterIgnore=!0})),this.rootObject.on("pointerup",(function(){t.rootObject.plugins.get("drag").moved=!1})),this.rootObject.on("mouseout",this.onHoverOutTile)},t.prototype.onResize=function(){return null!=this.lastTileMap?this.updateTileObjects(this.lastTileMap,this.lastRowLength):Promise.resolve(null)},t.getTilePositionInformation=function(t,e,i,n,r){return void 0===n&&(n=1),void 0===r&&(r=0),{x:n+1*(t%i+1-1),y:5==t?-.2:0,z:r+e-1*Math.trunc(t/i)}},t.prototype.handleTextureResize=function(t){t.width=this.tileSize,t.scale.y=t.scale.x},t.prototype.getSquareFactor=function(){return this.lastTileMap.rowLength},t.prototype.updateTile=function(t){if(t<0||t>=this.lastTileMap.length)throw new Error("Unexpected index");var e=this.getSquareFactor(),i=Math.trunc(t/e),n=t-i*e,r=.5*n+.5*i,s=-.25*n+.25*i+-this.lastTileMap[t].getLowestElevation()/4,o=2*(i*e+(e-n));null==this.tileObjects[t]&&(this.tileObjects[t]=new d(t,this.getTexture,this.loadedExplosionTextures),this.tileObjects[t].name="tile"+t,this.tileObjects[t].interactive=!0,this.tileObjects[t].on("pick",this.onPickTile),this.tileObjects[t].on("hoverin",this.onHoverInTile),this.tileObjects[t].on("hoverout",this.onHoverOutTile),this.tileObjects[t].on("hovermove",this.onHoverMoveTile),this.tileObjects[t].zIndex=0+o,this.tileObjects[t].tileRiskLevel.visible=!1,this.rootObject.addChild(this.tileObjects[t]),this.topLevelOrderChanged=!0),this.tileObjects[t].numPeople=Math.ceil(this.lastTileMap[t].population),this.tileObjects[t].tileSize=this.tileSize,this.tileObjects[t].slant=this.lastTileMap[t].getSlantDirection(),this.tileObjects[t].tileObject.texture=this.getTexture(this.lastTileMap[t].getGroundSprite()),this.tileObjects[t].tileObject.texture=this.getTexture(this.lastTileMap[t].getAppropriateBaseSprite()),this.tileObjects[t].tileSideHue=this.getTexture(this.lastTileMap[t].getGroundSprite()).baseTexture.averageHue,this.lastTileMap[t].leftColor=this.tileObjects[t].leftColor,this.lastTileMap[t].rightColor=this.tileObjects[t].rightColor,this.tileObjects[t].tileRiskLevel.base.tint=this.lastTileMap[t].getRiskLevelColor(),this.tileObjects[t].x=r*this.tileSize,this.tileObjects[t].y=(s+1)*this.tileSize;var a=this.lastTileMap[t].getAppropriateMainSprite();this.tileObjects[t].tileBuildingObject.texture=this.getTexture(a),t==this.currentlyHoveredTile&&(this.onHoverOutTile(null),this.onHoverInTile({target:this.tileObjects[t]})),u.queueRender()},t.prototype.getTexture=function(t){if(null==t)return o.Texture.EMPTY;var e=this.app.loader.resources[t];return null!=e?e.texture:o.Texture.EMPTY},t.prototype.getCentralPoint=function(){var t=Math.round(this.lastTileMap.getRows()/2*this.lastTileMap.rowLength+this.lastTileMap.rowLength/2),e=this.tileObjects[t];return new o.Point(e.x,e.y)},t.prototype.updateTileObjects=function(t,e){var i=this;return new Promise((function(n,r){i.lastTileMap=t,i.lastTileMap.tileSystem=i,i.lastRowLength=e;var s=Object(a.l)(t.length,i.updateTile,20);s.then((function(){i.topLevelOrderChanged&&(i.rootObject.sortChildren(),i.topLevelOrderChanged=!1),n(i.getCentralPoint())})),s.catch(r)}))},t}(),f=i(350),y=s.a.forwardRef((function(t,e){return s.a.createElement("i",{className:"fas fa-"+t.type,style:{color:t.color},ref:e})}));function m(t,e){return s.a.forwardRef((function(i,r){return s.a.createElement(y,Object(n.a)({type:t,color:e,ref:r},i))}))}m("shield-alt","#3bcc62");var g,b,w=m("home","#3d94ff"),x=m("info-circle","#b65bfc"),S=m("bomb","#cc2900"),T=m("arrow-up","#009933"),O=m("arrow-down","#009933"),k=(m("water","#00ccff"),m("mountain","#00cc00"),m("pause","#0099ff"),g="sprites/gui/risk_level_btn.png",s.a.forwardRef((function(t,e){return s.a.createElement("img",Object(n.a)({className:"disaster-image-icon",src:g,ref:e},t))}))),E=m("building","#996633"),j=(m("save","#0066ff"),m("chevron-left","#0066ff"),m("hammer","#996633")),C=m("male","#ff0000"),H=m("helicopter","#ff9933"),P=m("skull","#bbb"),M=m("question","#0099ff"),z=s.a.forwardRef((function(t,e){if(!t.show||null==t.name)return null;var i,n,r=t.riskColor.toString(16);return void 0!==t.residents&&t.occupancy>0&&(i=s.a.createElement(s.a.Fragment,null," ",s.a.createElement("span",null,s.a.createElement(w,null)," ",t.residents+"/"+t.occupancy))),t.dead>0&&(n=s.a.createElement(s.a.Fragment,null," ",s.a.createElement("span",null,s.a.createElement(P,null)," ",t.dead))),s.a.createElement("div",{className:"tile-overlay-container tile-overlay-"+(t.isSelected?"selected":"unselected")+" "+(t.embed?"tile-overlay-embed":""),ref:e,style:t.style},s.a.createElement("div",{className:"tile-risk-level-text",style:{backgroundColor:"#"+r}},t.riskLevel),s.a.createElement("div",{className:"tile-info-container"},t.name,s.a.createElement("p",null),s.a.createElement("span",{className:"icon-information"},s.a.createElement("span",null,s.a.createElement(C,null)," ",t.unhoused),i,n)))}));!function(t){t[t.Structures=0]="Structures",t[t.Teardown=1]="Teardown",t[t.TerraformUp=2]="TerraformUp",t[t.TerraformDown=3]="TerraformDown",t[t.ChangeGroundType=4]="ChangeGroundType",t[t.ShowInfo=5]="ShowInfo",t[t.Evacuate=6]="Evacuate"}(b||(b={}));var I=i(75),W=i(407),A=i(420),R=i(395),L=i(403),D=i(404),_=i(405),B=i(414),Y=i(406),N=function(t){var e=void 0,i=void 0;return void 0!==t.leftColor&&(e="#"+t.leftColor.toString(16),i="#"+t.rightColor.toString(16)),s.a.createElement("div",{className:"construction-avatar-container "+(t.mainSprite?"":"no-mainsprite ")+"selectDisable"},t.mainSprite&&s.a.createElement("img",{src:t.mainSprite,className:"construction-mainsprite selectDisable"}),t.baseSprite&&s.a.createElement("img",{src:t.baseSprite,className:"construction-basesprite selectDisable"}),e&&s.a.createElement("div",{className:"construction-avatar-side construction-avatar-leftside selectDisable",style:{backgroundColor:e}}),i&&s.a.createElement("div",{className:"construction-avatar-side construction-avatar-rightside selectDisable",style:{backgroundColor:i}}))},X=function(t){var e=void 0;return void 0!==t.occupancy&&(e=s.a.createElement(s.a.Fragment,null,s.a.createElement(w,null)," ",t.occupancy)),s.a.createElement("div",{className:"construction-building-info"},s.a.createElement(R.a,{variant:"h6"},t.name),s.a.createElement("span",null,e))},F=function(t){var e,i,r,o=Object(n.e)(s.a.useState(!1),2),a=o[0],l=o[1],h=t.buildable,c=s.a.useMemo((function(){return t.onChooseItem.bind(t,h)}),[t.onChooseItem,t.buildable]),u=s.a.useCallback((function(){return l(!1)}),[]),p=s.a.useCallback((function(){return l(!0)}),[]),d=void 0;void 0!==h.description&&(d=s.a.createElement("button",{onClick:p},s.a.createElement(x,null)));var v=void 0!==h.baseSprite?h.baseSprite:null===(e=t.targetTile)||void 0===e?void 0:e.getGroundSprite();return s.a.createElement(A.a,null,s.a.createElement(N,{mainSprite:h.mainSprite,baseSprite:v,leftColor:null===(i=t.targetTile)||void 0===i?void 0:i.leftColor,rightColor:null===(r=t.targetTile)||void 0===r?void 0:r.rightColor}),s.a.createElement(X,Object(n.a)({},h)),s.a.createElement("span",{className:"construction-item-buttons"},s.a.createElement("span",{className:"construction-item-buttons-spacer"}),d,s.a.createElement("button",{onClick:c},s.a.createElement(j,null))),void 0!==h.description&&s.a.createElement(B.a,{open:a,onClose:u},s.a.createElement(L.a,null,h.name),s.a.createElement(D.a,{dividers:!0},s.a.createElement(R.a,null,h.description)),s.a.createElement(_.a,null,s.a.createElement(Y.a,{onClick:u,color:"primary"},"OK"))))},V=function(t){return s.a.createElement(W.a,{className:"construction-build-options"},I.a.map((function(e){return e.hidden?null:s.a.createElement(F,{key:e.mainSprite,onChooseItem:t.onChooseItem,targetTile:t.targetTile,buildable:e})})))},G=function(t){var e,i,n,r,o;return s.a.createElement("div",{className:"construction-target-tile-wrapper",style:{backgroundColor:"#"+(null===(e=t.targetTile)||void 0===e?void 0:e.getRiskLevelColor().toString(16))}},"Risk "+(null===(i=t.targetTile)||void 0===i?void 0:i.riskLevel),s.a.createElement("div",null,s.a.createElement(N,{baseSprite:null===(n=t.targetTile)||void 0===n?void 0:n.getGroundSprite(),leftColor:null===(r=t.targetTile)||void 0===r?void 0:r.leftColor,rightColor:null===(o=t.targetTile)||void 0===o?void 0:o.rightColor})))},U=s.a.memo((function(t){var e=t.type==b.Teardown;return s.a.createElement(B.a,{open:t.show,onClose:t.onBuildCancel},s.a.createElement(L.a,null,"DEVELOPMENT: ",b[t.type]),s.a.createElement(D.a,{dividers:!0,className:"construction-dialog-content"},!e&&s.a.createElement("div",{className:"construction-dialog-summary"},s.a.createElement(G,{targetTile:t.targetTile}),s.a.createElement("div",{style:{display:"inline-block"}},"Choose a building to construct on this tile.")),e?s.a.createElement(R.a,null,"Are you sure you want to remove this?"):s.a.createElement(V,{targetTile:t.targetTile,type:t.type,onChooseItem:t.onChooseItem})),s.a.createElement(_.a,null,s.a.createElement(Y.a,{onClick:t.onBuildCancel,color:"primary"},e?"No":"Cancel"),e&&s.a.createElement(Y.a,{onClick:function(){return t.onChooseItem(null)},color:"primary"},"Yes")))})),q=i(359),Q=(i(418),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(n.c)(e,t),e.prototype.render=function(){return s.a.createElement("div",{className:"top-controls"},this.props.children)},e}(s.a.PureComponent)),K=function(){return s.a.createElement("span",{className:"controls-separator"})};function Z(){Object(a.i)("audio/hover.mp3")}var J=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(n.c)(e,t),e.prototype.render=function(){var t=this.props,e=t.icon,i=t.active,r=t.playHoverSound,o=(t.title,Object(n.f)(t,["icon","active","playHoverSound","title"])),a="hoverable-button control-button"+(i&&!o.disabled?" hoverable-button-active":""),l=e;void 0===r&&(r=!0);var h=s.a.createElement("button",Object(n.a)({onMouseEnter:r?Z:null,className:a},o),s.a.createElement(l,null));return h},e}(s.a.PureComponent),$=function(t){return s.a.createElement("span",{className:"control-group"},t.children)},tt=i(106),et=i(325),it=i(107),nt=i.n(it),rt=i(417),st=i(419),ot=i(409),at=function(t){function e(e){var i=t.call(this,e)||this;return i.intervalHandler=function(){if(!i.isPaused&&0!=i.state.timeRemaining){var t=i.state.timeRemaining-1e3;t<=0&&(i.props.onExpiry(),t=0),i.setState({timeRemaining:t})}},i.interval=-1,i.state={timeRemaining:e.amountOfTime},i.isPaused=!1,i}return Object(n.c)(e,t),e.prototype.componentDidMount=function(){0==this.state.timeRemaining&&this.props.onExpiry(),this.interval=setInterval(this.intervalHandler,1e3)},e.prototype.componentWillUnmount=function(){-1!=this.interval&&(clearInterval(this.interval),this.interval=-1)},e.prototype.render=function(){var t=this.state.timeRemaining,e=(Math.floor(t/864e5),Math.floor(t%864e5/36e5)),i=Math.floor(t%36e5/6e4),n=Math.floor(t%6e4/1e3),r=Object(a.h)(e,2)+":"+Object(a.h)(i,2)+":"+Object(a.h)(n,2);return s.a.createElement("span",{style:{color:this.state.timeRemaining>0?null:"red"}},r)},e}(s.a.PureComponent),lt=i(372),ht=i.n(lt),ct=function(t){var e=Object(n.e)(s.a.useState(!1),2),i=e[0],r=e[1],o=s.a.useCallback((function(t,e){r(e)}),[]);return s.a.useEffect((function(){t.forceOpen&&r(!0)}),[t.forceOpen]),s.a.createElement(rt.a,{square:!0,expanded:i,onChange:o,className:"population-info"},s.a.createElement(st.a,{expandIcon:s.a.createElement(ht.a,null)}),s.a.createElement(ot.a,null,s.a.createElement("div",{className:"population-column"},s.a.createElement(R.a,{variant:"h5"},"POPULATION"),s.a.createElement("p",null),s.a.createElement("ul",null,s.a.createElement("li",{style:{color:"red"}},"Deceased: ",t.dead),s.a.createElement("li",{style:{color:"black"}},"Homeless: ",t.unhoused),s.a.createElement("li",{style:{color:"green"}},"Sheltered: ",t.housed))),t.showTimer&&s.a.createElement("div",{className:"population-column"},s.a.createElement(R.a,{variant:"h5"},"DISASTER TIMER"),s.a.createElement("p",null),s.a.createElement(at,{amountOfTime:12e5,onExpiry:t.onExpiry}))))},ut=i(410),pt=i(260),dt=function(t){var e=Object(pt.a)(),i=t.fullScreen,r=Object(n.f)(t,["fullScreen"]);return i=i||Object(ut.a)(e.breakpoints.down("sm")),s.a.createElement(B.a,Object(n.a)({},r,{fullScreen:i}),t.children)};function vt(){var t,e;return ft(2)(.2*(t=Math.max(document.documentElement.clientWidth,window.innerWidth||0),e=Math.max(document.documentElement.clientHeight,window.innerHeight||0),Math.min(t,e)))}var ft=function(t){return function(e){return Math.round(e/t)*t}},yt=!1;function mt(t){var e=[];return e.push(t.mainSprite),void 0!==t.baseSprite&&e.push(t.baseSprite),void 0!==t.destroyedSprite&&t.destroyedSprite!=t.mainSprite&&e.push(t.destroyedSprite),e}var gt=function(t){var e,i=t.onClick,r=t.sticky,o=t.flag,a=t.active,l=t.constructionType,h=Object(n.f)(t,["onClick","sticky","flag","active","constructionType"]),c=s.a.useCallback((function(){i(l,r,o)}),[i,l,r,o]);return e="function"==typeof a?a(l,o):a,s.a.createElement(J,Object(n.a)({onClick:c,active:e},h))},bt=!1,wt=function(t){function e(e){var i=t.call(this,e)||this;return i.canvasRef=s.a.createRef(),i.nextStateToSet=null,i.previouslyChosenTile=null,i.pendingTimeouts=[],i._isMounted=!1,i.runDisaster=function(){var t=Object(a.b)(2e3,(function(){i.forceUpdate()}),!0);if(i.state.disasterRunning)throw new Error("Disaster already running");i.clearSelectedTile(),i.tileSystem.interactionAllowed=!0,i.setState({constructionType:b.ShowInfo,constructionFlag:null,stickyActionInProgress:!0,disasterRunning:!0},(function(){var e=function(e,n,r){return new Promise((function(s){var o=new Set,l=function(e,h){if(null!=e){var c=e.getIndex();if(!o.has(c)){o.add(c);var u,p=r?i.props.tileMap.length-o.size:o.size;u=r?0:100-Math.min(o.size/i.props.tileMap.length*110,100),u/=Math.max(0,e.getHighestElevation()+1),u+=-4*(e.getHighestElevation()-h)*Object(a.d)(.5,1);var d=1;i.doDisasterTileProcess(e,r,u,h)?i.tileSystem.updateTile(c):d=32,setTimeout((function(){var t=!0,i=e.getHighestElevation();n.forEach((function(n){var r=e.getTileInDirection(n);null!=r&&(t=!1);try{l(r,i)}catch(t){console.error(t)}})),t&&s(o)}),p/16/d),t()}}};try{l(e,e.getHighestElevation())}catch(t){console.error(t)}}))},n=i.props.tileMap[i.props.tileMap.length-i.props.tileMap.rowLength];e(n,[p.d.Northwest,p.d.Northeast],!1).then((function(t){i.forceUpdate();var n=Array.from(t);e(i.props.tileMap[n[n.length-1]],[p.d.Southwest,p.d.Southeast],!0).then((function(){i.tileSystem.interactionAllowed=!1,i.setState({constructionType:null,stickyActionInProgress:!1,disasterRunning:!1,disasterFinished:!0,currentlyHoveredTile:null,currentlySelectedTile:null})}))}))}))},i.invertRiskLevel=function(){Object(a.i)("audio/pop.mp3",(function(){i.tileSystem.tileRiskLevelVisible=!i.tileSystem.tileRiskLevelVisible,u.queueRender()}))},i.onErrorAcknowledge=function(){i.setState({showError:!1})},i.endQuery=function(){i.setState({showForcedQuery:!1})},i.closeNewspaper=function(){},i.hideInstructions=function(){i.setState({instructionsHidden:!0},(function(){return yt=!0}))},i.showInstructions=function(){return i.setState({instructionsHidden:!1})},i.cull=null,i.state={hoverX:null,hoverY:null,currentlyHoveredTile:null,currentlySelectedTile:null,constructionType:null,initiallyRendered:!1,willNeedToCull:!1,interactionAllowed:!1,tileRiskLevelVisible:!1,stickyActionInProgress:!1,constructionFlag:null,showError:!1,errString:"",disasterRunning:!1,expiryDate:0,forcedQueryTile:null,showForcedQuery:!1,disasterFinished:!1,newspaperClosed:!1,instructionsHidden:yt},i.nextStateToSet={},i.tileSystem=new v(i),i.clearSelectedTile=i.clearSelectedTile.bind(i),i.updatePixiSize=i.updatePixiSize.bind(i),i.performBuild=i.performBuild.bind(i),i.startTileBasedAction=i.startTileBasedAction.bind(i),i.checkActive=i.checkActive.bind(i),i}return Object(n.c)(e,t),e.prototype.clearFromPending=function(t){var e=this.pendingTimeouts.indexOf(t);-1!=e&&this.pendingTimeouts.splice(e,1)},e.prototype.setTimeout=function(t,e){for(var i=this,r=[],s=2;s<arguments.length;s++)r[s-2]=arguments[s];var o=setTimeout.apply(void 0,Object(n.g)([function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];i.clearFromPending(o),t.apply(void 0,Object(n.g)(e))},e],r));return this.pendingTimeouts.push(o),o},e.prototype.clearTimeout=function(t){this.clearTimeout(t),this.clearFromPending(t)},e.prototype.checkSnackbarCompatibility=function(t){bt||(bt=!0,"none"==window.getComputedStyle(t).display&&window.alert("It appears that you have an adblocker which is blocking some game notifications from appearing. You may want to disable it for this game (it does not have any ads)."))},e.prototype.performBuild=function(t){var e,i,r,s,o=t;this.state.currentlySelectedTile.building=JSON.parse(JSON.stringify(o)),this.state.currentlySelectedTile.building.id=nt.a.generate();var l=this.state.currentlySelectedTile.searchInRing(3),h=0;try{for(var c=Object(n.h)(l),u=c.next();!u.done;u=c.next()){var d=u.value;try{for(var v=(r=void 0,Object(n.h)(d)),f=v.next();!f.done;f=v.next()){var y=f.value,m=this.state.currentlySelectedTile.building.occupancy-h,g=Math.min(m,Math.min(this.props.tileMap[y].population,this.state.currentlySelectedTile.building.occupancy));g>0&&(this.props.tileMap[y].population-=g,this.tileSystem.updateTile(y),h+=g)}}catch(t){r={error:t}}finally{try{f&&!f.done&&(s=v.return)&&s.call(v)}finally{if(r)throw r.error}}}}catch(t){e={error:t}}finally{try{u&&!u.done&&(i=c.return)&&i.call(c)}finally{if(e)throw e.error}}this.state.currentlySelectedTile.building.residents+=h;var b=this.state.currentlySelectedTile.building.residents==this.state.currentlySelectedTile.building.occupancy;h>0&&this.props.enqueueSnackbar(h+" people "+(b?"(the maximum this building can hold) ":"")+" were safely sheltered!",{variant:"success",ref:this.checkSnackbarCompatibility}),null!=this.state.currentlySelectedTile.explosionOverride?(this.state.currentlySelectedTile.ground=this.state.currentlySelectedTile.explosionOverride,this.state.currentlySelectedTile.explosionOverride=null):Object(p.i)(this.state.currentlySelectedTile.ground,p.e.Sand)||(this.state.currentlySelectedTile.ground=p.e.Grass);this.state.currentlySelectedTile.getIndex();Object(a.i)("audio/construction.mp3"),this.onActionCompleted(this.state.currentlySelectedTile)},e.prototype.updatePixiSize=function(){var t=this;this.tileSystem.tileSize=vt(),this.tileSystem.app.renderer.resize(0,0),this.viewport.resize(this.tileSystem.app.view.clientWidth,this.tileSystem.app.view.clientHeight),this.tileSystem.app.renderer.resize(this.tileSystem.app.view.clientWidth,this.tileSystem.app.view.clientHeight),window.removeEventListener("resize",this.pixiSizeHandler),this.tileSystem.onResize().then((function(){t._isMounted&&(window.addEventListener("resize",t.pixiSizeHandler),t.viewport.dirty=!0)}))},e.prototype.onTileChange=function(t){this.state.currentlyHoveredTile!=this.props.tileMap[t]&&this.state.currentlySelectedTile!=this.props.tileMap[t]||this.forceUpdate()},e.prototype.componentWillUnmount=function(){for(var t in this._isMounted=!1,window.removeEventListener("resize",this.pixiSizeHandler),this.tileSystem.app.destroy(!1),this.pendingTimeouts.forEach((function(t){clearTimeout(t)})),this.pendingTimeouts=[],o.utils.BaseTextureCache)delete o.utils.BaseTextureCache[t];for(var t in o.utils.TextureCache)delete o.utils.TextureCache[t];this.tileSystem.lastTileMap.tileSystem=null,this.tileSystem=new v(this)},e.prototype.clearSelectedTile=function(t){var e=this;"object"==typeof t&&t.doIgnoreTileClick?t.doIgnoreTileClick=!1:this.setState({currentlySelectedTile:null},(function(){return e.tileSystem.clearSelectedTile(t)}))},e.prototype.doDisasterTileProcess=function(t,e,i,n){if(e)return 1!=t.wasPreviouslyWater?t.wasFlooded&&(Object(p.i)(t.oldGroundType,p.e.Sand)?t.ground=p.e.Sand:t.ground=p.e.Dirt1,t.setAllElevations(t.getHighestElevation()-.2)):t.setAllElevations(t.oldElevation),!0;if(t.wasFlooded=!1,t.wasPreviouslyWater=!1,Object(p.i)(t.ground,p.e.Water))return t.oldElevation=t.getHighestElevation(),t.setAllElevations(2),t.wasPreviouslyWater=!0,!0;if(t.oldGroundType=t.ground,t.ground=p.e.Water,t.wasFlooded=!0,t.dead+=t.population,t.population=0,i>20&&null!=t.building){t.building.destroyed=!0;var r=Math.round(3*t.building.residents/4);t.building.residents-=r,t.dead+=r}return!0},e.prototype.componentDidMount=function(){var t=this,e=this.props.tileMap;o.Application.prototype.render=null,this.tileSystem.app=new o.Application({view:this.canvasRef.current,transparent:!0}),this.tileSystem.app.view.addEventListener("contextmenu",(function(t){t.preventDefault()})),this.viewport=new f.a({screenWidth:this.tileSystem.app.view.clientWidth,screenHeight:this.tileSystem.app.view.clientHeight,worldWidth:1e3,worldHeight:1e3,divWheel:this.canvasRef.current,interaction:this.tileSystem.app.renderer.plugins.interaction}),this.viewport.zIndex=1e3,this.viewport.on("disaster-hover",(function(e){null!=t.state.currentlySelectedTile&&(delete e.hoverX,delete e.hoverY),t.nextStateToSet=Object.assign(t.nextStateToSet,e)})),this.viewport.on("disaster-tilepicked",(function(e){t.onTilePick(e.currentlySelectedTile)})),this.viewport.on("click",this.clearSelectedTile),this.tileSystem.app.stage.addChild(this.viewport),this.tileSystem.app.renderer.plugins.interaction.moveWhenInside=!0,this.tileSystem.app.renderer.plugins.interaction.setTargetElement(this.canvasRef.current),this.tileSystem.rootObject=this.viewport,this.tileSystem.plugins.forEach((function(e){return t.viewport[e]()})),this.tileSystem.tileSize=vt();var i=this.tileSystem.app.loader;this.tileSystem.loadedSprites=this.tileSystem.loadedSprites.concat(this.tileSystem.explosionSprites,Object.values(p.j),Object.values(p.e).map((function(t){return Object.values(t)})).flat(),I.a.map((function(t){return mt(t)})).flat(),I.b.map((function(t){return mt(t)})).flat(),"sprites/person.png").filter((function(t){return null!=t})),this._isMounted=!0,this.tileSystem.loadedSprites.forEach((function(t){return i.add(t,t)})),new Promise((function(t){return i.load(t)})).then((function(){t.tileSystem.setupObjects(),t.tileSystem.updateTileObjects(e).then((function(e){t.viewport.moveCenter(e),t.cull=new q.SpatialHash({dirtyTest:!1}),t.cull.addContainerPromisified=function(t,e){var i=this;return new Promise((function(n){var r=function(t){t[this.spatial]={hashes:[]},this.updateObject(t)}.bind(i),s=function(t){this.removeFromHash(t)}.bind(i);Object(a.l)(t.children.length,(function(e){var n=t.children[e];n[i.spatial]={hashes:[]},i.updateObject(n)}),20).then((function(){t.cull={},i.containers.push(t),t.on("childAdded",r),t.on("childRemoved",s),t.cull.added=r,t.cull.removed=s,e&&(t.cull.static=!0),n()}))}))},t.cull.addContainerPromisified(t.viewport).then((function(){t.viewport.dirty=!0;var e=!1;t.tileSystem.app.ticker.add((function(){if(Object.keys(t.nextStateToSet).length>0){try{t.setState(t.nextStateToSet)}catch(t){console.error("error",t)}t.nextStateToSet={}}t.viewport.dirty&&(t.cull.cull(t.viewport.getVisibleBounds()),u.queueRender()),(u.needsRender()||t.tileSystem.isDragging())&&(u._queuedRender=!1,t.tileSystem.app.renderer.render(t.tileSystem.app.stage),t.viewport.dirty=!1,e||(e=!0,t.setState({initiallyRendered:!0}),Object(a.j)("audio/construction.mp3"),Object(a.j)("audio/explosion.mp3"),Object(a.j)("audio/ocean.mp3")))}))}))}))})),this.pixiSizeHandler=Object(a.b)(250,this.updatePixiSize),window.addEventListener("resize",this.pixiSizeHandler),this.updatePixiSize()},e.prototype.getCurrentOverlayTile=function(){return null!=this.state.currentlyHoveredTile?this.state.currentlyHoveredTile:null!=this.state.currentlySelectedTile?this.state.currentlySelectedTile:null},e.prototype.isDialogBasedConstructionType=function(t){return t==b.Structures},e.prototype.checkActive=function(t,e){return t==this.state.constructionType&&(null!=e&&void 0!==e||(e=null),e==this.state.constructionFlag)},e.prototype.cancelCurrentAction=function(t,e){this.clearSelectedTile(),this.setState(Object.assign({},t,{constructionType:null,constructionFlag:null}),e),this.tileSystem.interactionAllowed=!1,this.previouslyChosenTile=null},e.prototype.startTileBasedAction=function(t,e,i){Object(a.i)("audio/pop.mp3"),null!=this.state.constructionType&&this.checkActive(t,i)?this.cancelCurrentAction():(this.previouslyChosenTile=null,this.tileSystem.interactionAllowed=!0,this.setState({constructionType:t,constructionFlag:i,stickyActionInProgress:e}))},e.prototype.performAction=function(t){var e=this;new Promise((function(i){var r,s;if(e.state.constructionType==b.TerraformDown){t.raiseWholeTile(-.5);var o=!1;try{for(var l=Object(n.h)(p.a),h=l.next();!h.done;h=l.next()){var c=h.value,u=t.getTileInDirection(c);if(null!=u&&u.getLowestElevation()>=t.getHighestElevation()&&Object(p.i)(u.ground,p.e.Water)){t.flood(),o=!0;break}}}catch(t){r={error:t}}finally{try{h&&!h.done&&(s=l.return)&&s.call(l)}finally{if(r)throw r.error}}Object(a.i)(o?"audio/flood.mp3":"audio/terraform.mp3",i)}else e.state.constructionType==b.TerraformUp?(t.raiseWholeTile(.5),Object(a.i)("audio/terraform.mp3",i)):e.state.constructionType==b.Teardown?e.tileSystem.tileObjects[t.getIndex()].triggerExplosion().then((function(){var r,s,o,a;if(null!=t.building){t.building.residents>0&&e.props.enqueueSnackbar(t.building.residents+" people just became homeless.",{variant:"warning",ref:e.checkSnackbarCompatibility});var l=t.searchInRing(3,p.a,(function(t){return!Object(p.i)(t.ground,p.e.Water)})),h=l.reduce((function(t,e){return t+e.length}),0),c=Math.trunc(t.building.occupancy/h);try{for(var u=Object(n.h)(l),d=u.next();!d.done;d=u.next()){var v=d.value;try{for(var f=(o=void 0,Object(n.h)(v)),y=f.next();!y.done;y=f.next()){var m=y.value;t.building.occupancy-=c,e.props.tileMap[m].population+=c,e.tileSystem.updateTile(m)}}catch(t){o={error:t}}finally{try{y&&!y.done&&(a=f.return)&&a.call(f)}finally{if(o)throw o.error}}}}catch(t){r={error:t}}finally{try{d&&!d.done&&(s=u.return)&&s.call(u)}finally{if(r)throw r.error}}t.population+=t.building.occupancy}t.building=null,Object(p.i)(t.ground,p.e.Sand)&&(t.explosionOverride=p.e.Sand),t.ground=p.e.Dirt1,i()})):e.state.constructionType==b.ChangeGroundType?(t.ground=e.state.constructionFlag,t.ground==p.e.Water?Object(a.i)("audio/ocean.mp3",i):i()):e.state.constructionType==b.ShowInfo?(e.setState({forcedQueryTile:t,showForcedQuery:!0}),Object(a.i)("audio/pop.mp3",i)):Object(a.i)("audio/pop.mp3",i)})).then((function(){return e.onActionCompleted(t)}))},e.prototype.onActionCompleted=function(t){null!=t&&this.tileSystem.updateTile(t.getIndex()),this.state.stickyActionInProgress||this.cancelCurrentAction()},e.prototype.setSelectionHighlightVisible=function(t,e){this.tileSystem.tileObjects[t.getIndex()].tileSelectionHighlight.visible=e},e.prototype.housePeople=function(t,e,i){var r,s,o,a,l=this;void 0===i&&(i=5);var h=t.searchInRing(i).flat(2).map((function(t){return l.props.tileMap[t]}));try{for(var c=Object(n.h)(h),u=c.next();!u.done;u=c.next()){var d=u.value;if(!Object(p.i)(d.ground,p.e.Water)&&null!=d.building){var v=Math.min(e,d.building.occupancy-d.building.residents);e-=v,d.building.residents+=v}}}catch(t){r={error:t}}finally{try{u&&!u.done&&(s=c.return)&&s.call(c)}finally{if(r)throw r.error}}var f=Math.floor(e/h.length);try{for(var y=Object(n.h)(h),m=y.next();!m.done;m=y.next()){d=m.value;Object(p.i)(d.ground,p.e.Water)||(d.population+=f,e-=f,this.tileSystem.updateTile(d.getIndex()))}}catch(t){o={error:t}}finally{try{m&&!m.done&&(a=y.return)&&a.call(y)}finally{if(o)throw o.error}}t.population+=e,this.tileSystem.updateTile(t.getIndex())},e.prototype.evacuateTiles=function(t,e){var i,r,s=this,o=t.searchInRing(7).flat(2).map((function(t){return s.props.tileMap[t]})),l=0;try{for(var h=Object(n.h)(o),c=h.next();!c.done;c=h.next()){var u=c.value;if(!Object(p.i)(u.ground,p.e.Water)){var d=Object(a.f)(0,u.population+1);if(l+=d,u.population-=d,null!=u.building){var v=Object(a.f)(0,u.building.residents+1);l+=v,u.building.residents-=v}this.tileSystem.updateTile(u.getIndex())}}}catch(t){i={error:t}}finally{try{c&&!c.done&&(r=h.return)&&r.call(h)}finally{if(i)throw i.error}}l>0?(this.housePeople(e,l,7),this.props.enqueueSnackbar(l+" people agreed to evacuate!",{variant:"success"})):this.props.enqueueSnackbar("No one chose to evacuate.",{variant:"error"})},e.prototype.checkActionAllowed=function(t){var e,i,r=this;if(this.state.constructionType==b.Structures){if(null!=t.building)return"You can't build that here; there is already something else on this tile.";if(Object(p.i)(t.ground,p.e.Water))return"Building in the ocean is too expensive and dangerous."}else if(this.state.constructionType==b.TerraformDown||this.state.constructionType==b.TerraformUp){var s=this.state.constructionType==b.TerraformDown?"lower":"raise";if(null!=t.building)return"You can't "+s+" tiles with something on them.";if(Object(p.i)(t.ground,p.e.Water))return"You can't "+s+" water.";var o={},a="get"+(this.state.constructionType==b.TerraformUp?"Lowest":"Highest")+"Elevation",l="get"+(this.state.constructionType==b.TerraformDown?"Lowest":"Highest")+"Elevation",h=t.getTileInDirection(p.d.Northwest);null!=h&&(o[p.d.Northwest]=h[a]());var c=t.getTileInDirection(p.d.Northeast);null!=c&&(o[p.d.Northeast]=c[a]());var u=t.getTileInDirection(p.d.Southwest);null!=u&&(o[p.d.Southwest]=u[a]());var d=t.getTileInDirection(p.d.Southeast);null!=d&&(o[p.d.Southeast]=d[a]());var v=t[l]();try{for(var f=Object(n.h)(Object.values(o)),y=f.next();!y.done;y=f.next()){var m=v-y.value;if(this.state.constructionType==b.TerraformUp&&m>=1.5||this.state.constructionType==b.TerraformDown&&m<=-1.5)return"You can't "+s+" that tile any further."}}catch(t){e={error:t}}finally{try{y&&!y.done&&(i=f.return)&&i.call(f)}finally{if(e)throw e.error}}}else if(this.state.constructionType==b.ChangeGroundType){if(this.state.constructionFlag==p.e.Water){if(null!=t.getSlantDirection())return"Water can't be slanted.";if(null!=t.building)return"Ground under a building can't be changed to water."}}else{if(this.state.constructionType==b.Teardown&&Object(p.i)(t.ground,p.e.Water))return"You can't clear water tiles.";if(this.state.constructionType==b.Evacuate){if(null==t.building||"Heliport"!=t.building.name&&"Hospital"!=t.building.name)return"Evacuation can only be done between heliports and/or hospitals.";if(null!=this.previouslyChosenTile&&t.searchInRing(7).some((function(t){return t.some((function(t){return r.props.tileMap[t]==r.previouslyChosenTile}))}))){this.setSelectionHighlightVisible(this.previouslyChosenTile,!1);var g=this.previouslyChosenTile==t;return this.previouslyChosenTile=null,g?"It's pointless to move people where they came from.":"These evacuation centres are too close to each other."}null!=this.previouslyChosenTile?(this.setSelectionHighlightVisible(this.previouslyChosenTile,!1),this.evacuateTiles(this.previouslyChosenTile,t),this.cancelCurrentAction()):this.setSelectionHighlightVisible(t,!0)}}return null},e.prototype.onTilePick=function(t){var e=this.checkActionAllowed(t);null!=e&&e.trim().length>0?(Object(a.i)("audio/error.mp3",void 0,void 0,!1),this.setState({showError:!0,errString:e})):(this.isDialogBasedConstructionType(this.state.constructionType)?this.setState({currentlySelectedTile:t}):this.performAction(t),this.previouslyChosenTile=t)},e.prototype.getTileName=function(t){var e,i;return(null===(e=t)||void 0===e?void 0:e.building)?t.building.name+(t.building.destroyed?" (destroyed)":""):Object(a.m)(Object(a.g)(p.e,null===(i=t)||void 0===i?void 0:i.ground))},e.prototype.validHover=function(){return null!=this.state.hoverX&&null!=this.state.hoverY},e.prototype.getDisasterString=function(){var t=this.props.tileMap.takeCensus(),e=t.dead/(t.housed+t.unhoused+t.dead)<=1/8;return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"head"},"Vicious tsunami strikes"),s.a.createElement("div",{className:"content"},s.a.createElement("div",{className:"columns"},s.a.createElement("div",{className:"column"},s.a.createElement("p",null,"On "+(new Date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})+", a devastating tsunami struck the region. The waves inundated many coastal buildings and most remaining displaced people were killed or severely injured."),e&&s.a.createElement("p",null,"The city's evacuations manager did an excellent job of providing shelter for displaced people. With their help, most of the population was able to survive the tsunami. Only ",t.dead," people died, compared to the ",t.housed," who had been safely sheltered."),e&&s.a.createElement("p",null,"Several other cities are now requesting to hire the evacuations manager on a contract basis."),!e&&s.a.createElement("p",null,'Civilians were furious about the steps taken to prevent damage. "Significantly more time could have been spent evacuating low-lying areas and sheltering those without homes," one angry survivor stated.'),!e&&s.a.createElement("p",null,"The disaster's toll on the city was high, with over ",t.dead," people dead."),!e&&s.a.createElement("p",null,"Local officials are looking for  a replacement for the current evacuations manager, who has been suspended pending a full investigation."),s.a.createElement("p",null,"Thanks for playing ",document.title,"! If you want to play the game again, refresh the page.")))))},e.prototype.render=function(){var t,e,i,r,o,a,l,h,c,u,p,d,v,f,y,m,g,w,j,C,P,I,W=this.getCurrentOverlayTile(),A=this.getTileName(W),R=this.props.tileMap.takeCensus(),X=s.a.createElement(s.a.Fragment,null,!1,s.a.createElement(J,{icon:M,onClick:this.showInstructions}),s.a.createElement(K,null),s.a.createElement($,null,s.a.createElement(J,{active:this.tileSystem.tileRiskLevelVisible,icon:k,onClick:this.invertRiskLevel,title:(this.state.tileRiskLevelVisible?"Hide":"Show")+" tile risk level"}),s.a.createElement(K,null),s.a.createElement(gt,{title:"Lower tile",sticky:!0,constructionType:b.TerraformDown,icon:O,onClick:this.startTileBasedAction,active:this.checkActive}),s.a.createElement(gt,{title:"Raise tile",sticky:!0,constructionType:b.TerraformUp,icon:T,onClick:this.startTileBasedAction,active:this.checkActive})),s.a.createElement(K,null),s.a.createElement($,null,s.a.createElement(gt,{title:"Add building",constructionType:b.Structures,icon:E,onClick:this.startTileBasedAction,active:this.checkActive}),s.a.createElement(gt,{title:"Clear tile",sticky:!0,constructionType:b.Teardown,icon:S,onClick:this.startTileBasedAction,active:this.checkActive})),s.a.createElement(gt,{title:"Query tile",sticky:!0,constructionType:b.ShowInfo,icon:x,onClick:this.startTileBasedAction,active:this.checkActive}),s.a.createElement(K,null),s.a.createElement(gt,{title:"Trigger evacuation",sticky:!0,constructionType:b.Evacuate,icon:H,onClick:this.startTileBasedAction,active:this.checkActive}),!1);return s.a.createElement(s.a.Fragment,null,this.state.initiallyRendered&&!this.state.disasterFinished&&s.a.createElement(Q,null,this.state.disasterRunning?"A disaster is taking place!":X),s.a.createElement(z,{constructionMode:!0,show:null!=W&&this.state.interactionAllowed&&this.validHover()&&!this.isDialogBasedConstructionType(this.state.constructionType),name:A,riskLevel:null===(t=W)||void 0===t?void 0:t.riskLevel,riskColor:null===(e=W)||void 0===e?void 0:e.getRiskLevelColor(),isSelected:!1,residents:null===(r=null===(i=W)||void 0===i?void 0:i.building)||void 0===r?void 0:r.residents,occupancy:null===(a=null===(o=W)||void 0===o?void 0:o.building)||void 0===a?void 0:a.occupancy,unhoused:null===(l=W)||void 0===l?void 0:l.population,dead:null===(h=W)||void 0===h?void 0:h.dead,style:{transform:"translateX(1em) translateY(-50%) translate("+this.state.hoverX+"px, "+this.state.hoverY+"px)"}}),s.a.createElement("canvas",{ref:this.canvasRef,style:{visibility:this.state.initiallyRendered?null:"hidden",touchAction:"none",cursor:"inherit"}}),!this.state.initiallyRendered&&s.a.createElement(tt.a,{loadingText:"Populating the area..."}),s.a.createElement(U,{show:null!=this.state.currentlySelectedTile&&this.isDialogBasedConstructionType(this.state.constructionType),type:this.state.constructionType,onChooseItem:this.performBuild,targetTile:this.state.currentlySelectedTile,onBuildCancel:this.onActionCompleted.bind(this,null)}),s.a.createElement(B.a,{open:this.state.showError,onClose:this.onErrorAcknowledge},s.a.createElement(L.a,null,"Action not allowed"),s.a.createElement(D.a,{dividers:!0},this.state.errString),s.a.createElement(_.a,null,s.a.createElement(Y.a,{onClick:this.onErrorAcknowledge,color:"primary"},"OK"))),s.a.createElement(B.a,{open:this.state.showForcedQuery,onClose:this.endQuery,hideBackdrop:!0},s.a.createElement(D.a,{className:"tile-overlay-embed-parent"},s.a.createElement(N,{mainSprite:null===(c=this.state.forcedQueryTile)||void 0===c?void 0:c.getAppropriateMainSprite(),baseSprite:null===(u=this.state.forcedQueryTile)||void 0===u?void 0:u.getAppropriateBaseSprite(),leftColor:null===(d=this.tileSystem.tileObjects[null===(p=this.state.forcedQueryTile)||void 0===p?void 0:p.getIndex()])||void 0===d?void 0:d.leftColor,rightColor:null===(f=this.tileSystem.tileObjects[null===(v=this.state.forcedQueryTile)||void 0===v?void 0:v.getIndex()])||void 0===f?void 0:f.rightColor}),s.a.createElement(z,{embed:!0,constructionMode:!0,show:null!=this.state.forcedQueryTile,name:this.getTileName(this.state.forcedQueryTile),riskLevel:null===(y=this.state.forcedQueryTile)||void 0===y?void 0:y.riskLevel,riskColor:null===(m=this.state.forcedQueryTile)||void 0===m?void 0:m.getRiskLevelColor(),isSelected:!1,residents:null===(w=null===(g=this.state.forcedQueryTile)||void 0===g?void 0:g.building)||void 0===w?void 0:w.residents,occupancy:null===(C=null===(j=this.state.forcedQueryTile)||void 0===j?void 0:j.building)||void 0===C?void 0:C.occupancy,unhoused:null===(P=this.state.forcedQueryTile)||void 0===P?void 0:P.population,dead:null===(I=this.state.forcedQueryTile)||void 0===I?void 0:I.dead})),s.a.createElement(_.a,null,s.a.createElement(Y.a,{onClick:this.endQuery,color:"primary"},"OK"))),this.state.initiallyRendered&&s.a.createElement(ct,Object(n.a)({showTimer:!this.state.disasterFinished&&!this.state.disasterRunning,forceOpen:this.state.disasterFinished},R,{onExpiry:this.runDisaster})),s.a.createElement(dt,{open:this.state.disasterFinished&&!this.state.newspaperClosed,onClose:this.closeNewspaper},s.a.createElement(D.a,{className:"newspaper"},this.getDisasterString())),s.a.createElement(dt,{open:this.state.initiallyRendered&&!this.state.instructionsHidden,onClose:this.hideInstructions},s.a.createElement(L.a,null,yt?"Instructions":"Welcome"),s.a.createElement(D.a,null,!yt&&s.a.createElement(s.a.Fragment,null,"Welcome to ",document.title,"!",s.a.createElement("p",null)),s.a.createElement("strong",null,"Objective"),s.a.createElement("p",null),"The goal of this game is to protect the residents of a city against an impending tsunami.",s.a.createElement("p",null),"You have 20 minutes to evacuate dangerous areas and shelter any displaced people before the tsunami arrives.",s.a.createElement("p",null),s.a.createElement("strong",null,"How to play"),s.a.createElement("p",null),"You can drag the map around to see the whole city. You can also zoom by either pinching or using the mouse wheel, depending on your device.",s.a.createElement("p",null),"Most buttons require you to choose a tile to perform an action on. Click the button, and then click the tile you would like to work with.",s.a.createElement("p",null),s.a.createElement("strong",null,"Construction"),s.a.createElement("p",null),"Construction is performed with the ",s.a.createElement(E,null)," button. You'll be offered a list of buildings to choose from.",s.a.createElement("p",null),s.a.createElement("strong",null,"Evacuation"),s.a.createElement("p",null),"Evacuation can be used to quickly move a large population from a dangerous area to a safer one. Click the ",s.a.createElement(H,null)," button, then click on two different tiles. The first tile is used to determine the area to move people ",s.a.createElement("i",null,"from"),". The second tile marks the general area people should evacuate ",s.a.createElement("i",null,"to"),".",s.a.createElement("p",null),s.a.createElement("strong",null,"Querying tiles"),s.a.createElement("p",null),"Sometimes, you may want to find out more information about a tile. When you click the ",s.a.createElement(x,null)," button, you will be able to hover (in the case of a mouse) or click on a tile to see more information about it.",s.a.createElement("p",null),"You'll be able to see the risk level of the tile (higher risk levels are more dangerous) as well as who and what currently resides on it.",s.a.createElement("p",null),"If you want a fast way to see risky areas, clicking on the ",s.a.createElement(k,null)," button will cause the tiles to display the color of their risk level.",s.a.createElement("p",null),s.a.createElement("strong",null,"Global statistics"),s.a.createElement("p",null),"The panel at the bottom of the screen can be opened to see general statistics about the whole population as well as how much time is left before the disaster.",s.a.createElement("p",null),s.a.createElement("strong",null,"The disaster"),s.a.createElement("p",null),"After 20 minutes, the tsunami will arrive. While the disaster is taking place, you will be able to query tiles and look at the global statistics panel, but you cannot evacuate anyone or build more buildings.",s.a.createElement("p",null),"To win the game, you must successfully keep 7/8 of the population from dying.",s.a.createElement("p",null),"Good luck! If you want to refer to these instructions later, you can click on the ",s.a.createElement(M,null)," button."),s.a.createElement(_.a,null,s.a.createElement(Y.a,{color:"primary",onClick:this.hideInstructions},yt?"OK":"Start"))))},e}(s.a.PureComponent),xt=Object(et.withSnackbar)(wt);e.default=function(t){return s.a.createElement(et.SnackbarProvider,null,s.a.createElement(xt,Object(n.a)({},t),t.children))}}}]);